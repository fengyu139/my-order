import{_ as V,b as B,o as g,d as P,f as $,H as A,k as j,e as I,a as q,a8 as L,i as U,R as Q,am as X,c as v,w as Z,h as D,s as x,t as H,G as ee,ao as te,ap as re,j as se,l as R,n as E,A as oe}from"./index-394e3bcc.js";import{p as ne}from"./pxCheck-OnXlN1NC-3938f682.js";import{N as le}from"./Cell-8767dc6a.js";const{create:ae}=B("cell-group"),ie=ae({props:{title:{type:String,default:""},desc:{type:String,default:""}}}),ue={class:"nut-cell-group"},ce={key:1,class:"nut-cell-group__title"},pe={key:3,class:"nut-cell-group__desc"},de={class:"nut-cell-group__wrap"};function fe(e,t,r,s,i,u){return g(),P("view",ue,[e.$slots.title?$(e.$slots,"title",{key:0}):e.title?(g(),P("view",ce,A(e.title),1)):j("",!0),e.$slots.desc?$(e.$slots,"desc",{key:2}):e.desc?(g(),P("view",pe,A(e.desc),1)):j("",!0),I("view",de,[$(e.$slots,"default")])])}const me=V(ie,[["render",fe]]);var ye=Object.defineProperty,W=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable,z=(e,t,r)=>t in e?ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ge=(e,t)=>{for(var r in t||(t={}))_e.call(t,r)&&z(e,r,t[r]);if(W)for(var r of W(t))ve.call(t,r)&&z(e,r,t[r]);return e};const he=e=>{const t=q([]),r=q([]);return{children:t,linkChildren:i=>{L(e,ge({unlink:n=>{if(n.proxy){let l=r.indexOf(n);l>-1&&r.splice(l,1);let f=t.indexOf(n.proxy);l>-1&&t.splice(f,1)}},link:n=>{n.proxy&&(r.push(n),t.push(n.proxy))},children:t,internalChildren:r},i))}}},be=e=>{const t=U(e,null);if(t){const r=X(),{link:s,unlink:i}=t;s(r),Q(()=>{i(r)})}return{parent:t}},K=Symbol("nut-form");var G=Object.getOwnPropertySymbols,Pe=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable,we=(e,t)=>{var r={};for(var s in e)Pe.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&G)for(var s of G(e))t.indexOf(s)<0&&$e.call(e,s)&&(r[s]=e[s]);return r},Se=(e,t,r)=>new Promise((s,i)=>{var u=l=>{try{n(r.next(l))}catch(f){i(f)}},c=l=>{try{n(r.throw(l))}catch(f){i(f)}},n=l=>l.done?s(l.value):Promise.resolve(l.value).then(u,c);n((r=r.apply(e,t)).next())});const Oe=e=>({props:{modelValue:{type:Object,default:()=>({})},rules:{type:Object,default:()=>({})},labelPosition:{type:String,default:"left"},starPosition:{type:String,default:"left"}},components:e,emits:["validate"],setup(t,{emit:r}){const{children:s,linkChildren:i}=he(K);i({props:t});const u=v(()=>q({}));L("formErrorTip",u);const c=()=>{Object.keys(u.value).forEach(o=>{u.value[o]=""})},n=()=>{c()};Z(()=>t.modelValue,()=>{c()},{immediate:!0});const l=()=>{const o=[];return s.forEach(a=>{o.push({prop:a==null?void 0:a.prop,rules:(a==null?void 0:a.rules)||[]})}),o},f=o=>{o.message&&r("validate",o),u.value[o.prop]=o.message},M=o=>Se(this,null,function*(){const{rules:a,prop:m}=o,_=w=>new Promise((S,O)=>{try{f(w),S(w)}catch(k){O(k)}});m||console.warn("[NutUI] <FormItem> 使用 rules 校验规则时 , 必须设置 prop 参数");const h=te(t.modelValue,m||"");f({prop:m,message:""});const y=t.rules||{},b=[...(y==null?void 0:y[m])||[],...a];for(;b.length;){const S=b.shift(),{validator:O}=S,k=we(S,["validator"]),{required:Y,regex:T,message:J}=k,C={prop:m,message:J||""};if(Y&&!h&&h!==0||T&&!T.test(String(h)))return _(C);if(O){const N=O(h,k);if(re(N))try{if((yield N)===!1)return _(C)}catch(F){return _({prop:m,message:F})}else if(!N)return _(C)}}return Promise.resolve(!0)}),p=(o="")=>new Promise((a,m)=>{try{const h=l().map(y=>o&&o!==y.prop?Promise.resolve(!0):M(y));Promise.all(h).then(y=>{y=y.filter(w=>w!==!0);const b={valid:!0,errors:[]};y.length&&(b.valid=!1,b.errors=y),a(b)})}catch(_){m(_)}});return{validate:p,reset:n,submit:()=>(p(),!1),formErrorTip:u}}}),{create:ke}=B("form"),Ce=ke(Oe({NutCellGroup:me}));function Ee(e,t,r,s,i,u){const c=D("nut-cell-group");return g(),P("form",{class:"nut-form",action:"#",onSubmit:ee(()=>!1,["prevent"])},[x(c,null,{default:H(()=>[$(e.$slots,"default")]),_:3})],32)}const Te=V(Ce,[["render",Ee]]),{create:Ae}=B("form-item"),je=Ae({inheritAttrs:!1,props:{prop:{type:String,default:""},label:{type:String,default:""},rules:{type:Array,default:()=>[]},required:{type:Boolean,default:!1},showErrorMessage:{type:Boolean,default:!0},showErrorLine:{type:Boolean,default:!0},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:""},errorMessageAlign:{type:String,default:""},bodyAlign:{type:String,default:""},labelPosition:{type:String,default:""},starPosition:{type:String,default:""}},components:{NutCell:le},setup(e,{slots:t}){const{parent:r}=be(K),s=v(()=>{var p;const d=(p=r.props)==null?void 0:p.rules;let o=!1;for(const a in d)Object.prototype.hasOwnProperty.call(d,a)&&a===e.prop&&Array.isArray(d[a])&&(o=d[a].some(m=>m.required));return e.required||e.rules.some(a=>a.required)||o}),i=v(()=>{const p=r.props.labelPosition,d=e.labelPosition?e.labelPosition:p;return d!=="left"?`nut-form-item__${d}`:""}),u=v(()=>{const p=r.props.starPosition,d=e.starPosition?e.starPosition:p;return d!=="left"?`nut-form-item__star-${d}`:""}),c=U("formErrorTip"),n=v(()=>({width:ne(e.labelWidth),textAlign:e.labelAlign})),l=v(()=>({textAlign:e.bodyAlign})),f=v(()=>({textAlign:e.errorMessageAlign}));return{parent:c,labelStyle:n,bodyStyle:l,errorMessageStyle:f,getSlots:p=>t[p],isRequired:s,labelPositionClass:i,starPositionClass:u}}}),Ne={class:"nut-cell__value nut-form-item__body"};function Ie(e,t,r,s,i,u){const c=D("nut-cell");return g(),se(c,{class:R(["nut-form-item",[{error:e.parent[e.prop],line:e.showErrorLine},e.$attrs.class,e.labelPositionClass]]),style:E(e.$attrs.style)},{default:H(()=>[e.label||e.getSlots("label")?(g(),P("view",{key:0,class:R(["nut-cell__title nut-form-item__label",{required:e.isRequired,[e.starPositionClass]:e.starPositionClass}]),style:E(e.labelStyle)},[$(e.$slots,"label",{},()=>[oe(A(e.label),1)])],6)):j("",!0),I("view",Ne,[I("view",{class:"nut-form-item__body__slots",style:E(e.bodyStyle)},[$(e.$slots,"default")],4),e.parent[e.prop]&&e.showErrorMessage?(g(),P("view",{key:0,class:"nut-form-item__body__tips",style:E(e.errorMessageStyle)},A(e.parent[e.prop]),5)):j("",!0)])]),_:3},8,["class","style"])}const Fe=V(je,[["render",Ie]]);export{Fe as N,Te as a};
