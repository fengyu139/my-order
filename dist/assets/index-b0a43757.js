import{J as V,K as X,o as r,d,l as _,n as v,e as y,a4 as q,c as U,_ as j,b as I,h as C,H as w,k as f,f as L,s as B,aD as W,Y as Q,r as O,w as J,T as K,aE as Y,j as S,aj as A,F as E,C as Z,a as G}from"./index-6ced0f24.js";import{g as x}from"./Checked-72beb956.js";const ee=X("del"),te=y("path",{d:"M668.444 1024H355.556c-142.223 0-256-113.778-256-256V170.667h824.888V768c0 142.222-113.777 256-256 256zM184.89 256v512c0 93.867 76.8 170.667 170.667 170.667h312.888c93.867 0 170.667-76.8 170.667-170.667V256H184.89zm753.778 0H85.333c-22.755 0-42.666-19.911-42.666-42.667s19.91-42.666 42.666-42.666h853.334c22.755 0 42.666 19.91 42.666 42.666S961.423 256 938.667 256zM625.777 85.333H398.223c-22.755 0-42.666-19.91-42.666-42.666S375.466 0 398.222 0h227.556c22.755 0 42.666 19.911 42.666 42.667s-19.91 42.666-42.666 42.666z",fill:"currentColor","fill-opacity":"0.9"},null,-1),se=[te];function ae(e,a,t,l,h,p){return r(),d("svg",{class:_(e.classes),style:v(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},se,6)}const le=V(ee,[["render",ae]]),oe=X("link"),re=y("path",{d:"M313.034 1004.045c-66.848 0-124.402-24.156-170.798-70.577l-40.854-40.829C54.96 846.218 28.966 783.097 30.83 714.411c3.702-66.85 31.56-131.808 79.819-180.12l137.4-137.373c14.86-14.861 40.855-14.861 55.69 0 14.86 14.861 16.725 38.99 0 55.69l-137.348 137.4a187.47 187.47 0 0 0-55.69 126.24c-1.864 46.422 14.835 89.115 46.396 120.675l40.855 40.855c31.56 31.56 74.253 48.286 120.674 46.421 46.421-1.838 92.843-22.291 126.24-55.69l137.4-137.4c14.862-14.86 40.856-14.86 55.69 0 14.862 14.862 14.862 40.856 0 55.69l-137.4 137.427c-48.285 48.259-113.27 76.117-180.118 79.82a5.645 5.645 0 0 0-7.405 0zm475.294-382.477c-11.133 0-18.563-3.702-27.832-12.997-14.86-14.861-14.86-40.855 0-55.69l115.082-115.108a187.47 187.47 0 0 0 55.716-126.267c1.838-46.395-14.861-89.114-46.421-120.674l-40.855-40.855c-64.985-64.959-176.364-61.257-246.915 9.294L478.266 278.108c-14.835 14.835-40.829 14.835-55.69 0-14.86-14.861-14.86-40.855 0-55.716l118.81-118.81C643.524 1.444 803.163-2.232 899.734 94.287l40.829 40.855c46.421 46.421 72.415 109.541 70.55 178.228-3.702 66.85-31.56 131.807-79.819 180.093L816.186 608.571c-7.43 7.43-18.563 11.133-27.858 12.997zm-332.327-1.864c-11.16 0-18.564-3.702-27.832-12.997-14.888-14.835-14.888-40.829 0-55.69l148.506-148.532c14.861-14.862 40.855-14.862 55.69 0 14.861 14.86 14.861 40.854 0 55.69L483.832 606.706c-7.404 7.43-18.563 11.159-27.831 12.997z",fill:"currentColor","fill-opacity":"0.9"},null,-1),ne=[re];function ie(e,a,t,l,h,p){return r(),d("svg",{class:_(e.classes),style:v(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},ne,6)}const ue=V(oe,[["render",ie]]),ce=X("photograph"),de=y("path",{d:"M570.514 789.943c-119.954 0-219.428-99.474-219.428-219.429s99.474-219.428 219.428-219.428 219.429 99.474 219.429 219.428-99.474 219.429-219.429 219.429zm0-351.086c-73.143 0-131.657 58.514-131.657 131.657s58.514 131.657 131.657 131.657 131.657-58.514 131.657-131.657-58.514-131.657-131.657-131.657zM877.714 1024h-614.4C117.03 1024 0 906.971 0 760.686V380.343c0-146.286 117.029-263.314 263.314-263.314h32.183c0-2.926 2.926-8.778 2.926-11.703C315.977 43.886 374.49 0 438.857 0h263.314c70.218 0 128.732 49.737 143.36 117.029h32.183c146.286 0 263.315 117.028 263.315 263.314v380.343C1141.029 906.97 1024 1024 877.714 1024zm-614.4-819.2c-96.548 0-175.543 78.994-175.543 175.543v380.343c0 96.548 78.995 175.543 175.543 175.543h614.4c96.549 0 175.543-78.995 175.543-175.543V380.343c0-96.549-78.994-175.543-175.543-175.543H819.2c-32.183 0-58.514-26.331-58.514-58.514S734.354 87.77 702.17 87.77H438.857c-26.331 0-49.737 17.555-55.588 40.96-2.926 5.852-2.926 11.703-2.926 17.555 0 32.183-26.332 58.514-58.514 58.514h-58.515zm-87.771 160.914a73.143 73.143 0 1 0 146.286 0 73.143 73.143 0 1 0-146.286 0Z",fill:"currentColor","fill-opacity":"0.9"},null,-1),pe=[de];function he(e,a,t,l,h,p){return r(),d("svg",{class:_(e.classes),style:v(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1141 1024",role:"presentation"},pe,6)}const ge=V(ce,[["render",he]]),{create:fe}=I("progress"),me=fe({components:{Checked:x},props:{percentage:{type:[Number,String],default:0,required:!0},size:{type:String,default:"base"},status:{type:String,default:"text"},strokeWidth:{type:[Number,String],default:""},textInside:{type:Boolean,default:!1},showText:{type:Boolean,default:!0},strokeColor:{type:String,default:""},textColor:{type:String,default:""},textBackground:{type:String,default:""},isShowPercentage:{type:Boolean,default:!0}},setup(e){const a=!!q().default,t=U(()=>{if(e.strokeWidth)return e.strokeWidth+"px"}),l=U(()=>Number(e.percentage)>=100?100:Number(e.percentage)),h=U(()=>({width:l.value+"%",background:e.strokeColor||""})),p=U(()=>({color:e.textColor||""}));return{height:t,percentage:l,bgStyle:h,textStyle:p,slotDefault:a}}}),ye={class:"nut-progress"};function ve(e,a,t,l,h,p){const b=C("Checked");return r(),d("div",ye,[y("div",{class:_(["nut-progress-outer",[e.showText&&!e.textInside?"nut-progress-outer-part":"",e.size?"nut-progress-"+e.size:""]]),style:v({height:e.height})},[y("div",{class:_(["nut-progress-inner",e.status==="active"?"nut-active":""]),style:v(e.bgStyle)},null,6),e.showText&&e.textInside&&!e.slotDefault?(r(),d("div",{key:0,class:"nut-progress-text nut-progress-insidetext",style:v({lineHeight:e.height,left:`${e.percentage}%`,transform:`translate(-${+e.percentage}%,-50%)`,background:e.textBackground||e.strokeColor})},[y("span",{style:v(e.textStyle)},w(e.percentage)+w(e.isShowPercentage?"%":""),5)],4)):f("",!0),e.showText&&e.textInside&&e.slotDefault?(r(),d("div",{key:1,class:"nut-progress-slot",style:v({position:"absolute",top:"50%",left:`${e.percentage}%`,transform:`translate(-${+e.percentage}%,-50%)`})},[L(e.$slots,"default")],4)):f("",!0)],6),e.showText&&!e.textInside?(r(),d("div",{key:0,class:"nut-progress-text",style:v({lineHeight:e.height})},[e.status==="text"||e.status==="active"?(r(),d("span",{key:0,style:v(e.textStyle)},w(e.percentage)+w(e.isShowPercentage?"%":""),5)):e.status==="icon"?L(e.$slots,"icon-name",{key:1},()=>[B(b,{width:"15px",height:"15px",color:"#439422"})]):f("",!0)],4)):f("",!0)])}const R=j(me,[["render",ve]]);var we=Object.defineProperty,_e=(e,a,t)=>a in e?we(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,n=(e,a,t)=>(_e(e,typeof a!="symbol"?a+"":a,t),t);class ke{constructor(){n(this,"url",""),n(this,"name","file"),n(this,"fileType","image"),n(this,"formData"),n(this,"sourceFile"),n(this,"method","post"),n(this,"xhrState",200),n(this,"timeout",30*1e3),n(this,"headers",{}),n(this,"withCredentials",!1),n(this,"onStart"),n(this,"taroFilePath"),n(this,"onProgress"),n(this,"onSuccess"),n(this,"onFailure"),n(this,"beforeXhrUpload")}}let Ce=class{constructor(a){n(this,"options"),this.options=a}upload(){var a;const t=this.options,l=new XMLHttpRequest;if(l.timeout=t.timeout,l.upload){l.upload.addEventListener("progress",h=>{var p;(p=t.onProgress)==null||p.call(t,h,t)},!1),l.onreadystatechange=()=>{var h,p;l.readyState===4&&(l.status==t.xhrState?(h=t.onSuccess)==null||h.call(t,l.responseText,t):(p=t.onFailure)==null||p.call(t,l.responseText,t))},l.withCredentials=t.withCredentials,l.open(t.method,t.url,!0);for(const[h,p]of Object.entries(t.headers))l.setRequestHeader(h,p);(a=t.onStart)==null||a.call(t,t),t.beforeXhrUpload?t.beforeXhrUpload(l,t):l.send(t.formData)}else console.warn("浏览器不支持 XMLHttpRequest")}};const{translate:be}=I("uploader");class Se{constructor(){n(this,"status","ready"),n(this,"message",be("ready")),n(this,"uid",new Date().getTime().toString()),n(this,"name"),n(this,"url"),n(this,"type"),n(this,"path"),n(this,"percentage",0),n(this,"formData",{})}}const{create:$e,translate:D}=I("uploader"),De=$e({components:{[R.name]:R,Photograph:ge,Failure:W,Loading:Q,Del:le,Link:ue},props:{name:{type:String,default:"file"},url:{type:String,default:""},timeout:{type:[Number,String],default:1e3*30},fileList:{type:Array,default:()=>[]},isPreview:{type:Boolean,default:!0},listType:{type:String,default:"picture"},isDeletable:{type:Boolean,default:!0},method:{type:String,default:"post"},capture:{type:Boolean,default:!1},maximize:{type:[Number,String],default:Number.MAX_VALUE},maximum:{type:[Number,String],default:1},clearInput:{type:Boolean,default:!0},accept:{type:String,default:"*"},headers:{type:Object,default:{}},data:{type:Object,default:{}},xhrState:{type:[Number,String],default:200},withCredentials:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autoUpload:{type:Boolean,default:!0},beforeUpload:{type:Function,default:null},beforeXhrUpload:{type:Function,default:null},beforeDelete:{type:Function,default:()=>!0},onChange:{type:Function}},emits:["start","progress","oversize","success","failure","change","delete","update:fileList","fileItemClick"],setup(e,{emit:a}){const t=O(e.fileList),l=O([]);J(()=>e.fileList,()=>{t.value=e.fileList});const h=()=>{let s={class:"nut-uploader__input",type:"file",accept:e.accept,multiple:e.multiple,name:e.name,disabled:e.disabled};return e.capture&&(s.capture="camera",s.accept||(s.accept="image/*")),K("input",s)},p=s=>{s.value=""},b=s=>{a("fileItemClick",{fileItem:s})},P=(s,i)=>{const c=new ke;c.url=e.url,c.formData=s.formData,c.timeout=e.timeout*1,c.method=e.method,c.xhrState=e.xhrState,c.headers=e.headers,c.withCredentials=e.withCredentials,c.beforeXhrUpload=e.beforeXhrUpload;try{c.sourceFile=s.formData.get(e.name)}catch(o){console.warn("[NutUI] <Uploader> formData.get(name)",o)}c.onStart=o=>{s.status="ready",s.message=D("readyUpload"),$(i),a("start",o)},c.onProgress=(o,g)=>{s.status="uploading",s.message=D("uploading"),s.percentage=(o.loaded/o.total*100).toFixed(0),a("progress",{event:o,option:g,percentage:s.percentage})},c.onSuccess=(o,g)=>{s.status="success",s.message=D("success"),a("success",{responseText:o,option:g,fileItem:s}),a("update:fileList",t.value)},c.onFailure=(o,g)=>{s.status="error",s.message=D("error"),a("failure",{responseText:o,option:g,fileItem:s})};let m=new Ce(c);e.autoUpload?m.upload():l.value.push(new Promise(o=>{o(m)}))},$=(s=-1)=>{s>-1?l.value.splice(s,1):(l.value=[],t.value=[],a("update:fileList",t.value))},N=()=>{Promise.all(l.value).then(s=>{s.forEach(i=>i.upload())})},T=s=>{s.forEach((i,c)=>{const m=new FormData;for(const[g,M]of Object.entries(e.data))m.append(g,M);m.append(e.name,i);const o=G(new Se);if(o.name=i.name,o.status="ready",o.type=i.type,o.formData=m,o.message=D("waitingUpload"),P(o,c),e.isPreview&&i.type.includes("image")){const g=new FileReader;g.onload=M=>{o.url=M.target.result,t.value.push(o)},g.readAsDataURL(i)}else t.value.push(o)})},H=s=>{const i=e.maximum*1,c=e.maximize*1,m=new Array;s=s.filter(g=>g.size>c?(m.push(g),!1):!0),m.length&&a("oversize",m);let o=s.length+t.value.length;return o>i&&s.splice(s.length-(o-i)),s},u=(s,i)=>{t.value.splice(i,1),a("delete",{file:s,fileList:t.value,index:i})},z=(s,i)=>{$(i),Y(e.beforeDelete,{args:[s,t.value],done:()=>u(s,i)})},F=s=>{if(e.disabled)return;const i=s.target;let{files:c}=i;e.beforeUpload?e.beforeUpload(c).then(m=>k(m)):k(c),a("change",{fileList:t.value,event:s}),e.clearInput&&p(i)},k=s=>{const i=H(new Array().slice.call(s));T(i)};return{onChange:F,onDelete:z,fileList:t,fileItemClick:b,clearUploadQueue:$,submit:N,renderInput:h}}}),Le={class:"nut-uploader"},ze={key:0,class:"nut-uploader__slot"},Fe={key:0,class:"nut-uploader__preview-img"},Ue={key:0,class:"nut-uploader__preview__progress"},Be={class:"nut-uploader__preview__progress__msg"},Pe=["onClick"],Ne=["src","onClick"],Te={key:3,class:"nut-uploader__preview-img__file"},He=["onClick"],Me={class:"file__name_tips"},Ve={class:"tips"},Xe={key:1,class:"nut-uploader__preview-list"},Ie=["onClick"],Oe={class:"file__name_tips"};function Ae(e,a,t,l,h,p){const b=C("Failure"),P=C("Loading"),$=C("Link"),N=C("Del"),T=C("nut-progress"),H=C("Photograph");return r(),d("view",Le,[e.$slots.default?(r(),d("view",ze,[L(e.$slots,"default"),Number(e.maximum)-e.fileList.length?(r(),S(A(e.renderInput),{key:0,onChange:e.onChange},null,40,["onChange"])):f("",!0)])):f("",!0),(r(!0),d(E,null,Z(e.fileList,(u,z)=>{var F;return r(),d("view",{key:u.uid,class:_(["nut-uploader__preview",[e.listType]])},[e.listType=="picture"&&!e.$slots.default?(r(),d("view",Fe,[u.status!="success"?(r(),d("view",Ue,[u.status!="ready"?(r(),d(E,{key:0},[u.status=="error"?(r(),S(b,{key:0,color:"#fff"})):(r(),S(P,{key:1,name:"loading",color:"#fff"}))],64)):f("",!0),y("view",Be,w(u.message),1)])):f("",!0),e.isDeletable?(r(),d("view",{key:1,class:"close",onClick:k=>e.onDelete(u,z)},[L(e.$slots,"delete-icon",{},()=>[B(b)])],8,Pe)):f("",!0),(F=u==null?void 0:u.type)!=null&&F.includes("image")&&u.url?(r(),d("img",{key:2,class:"nut-uploader__preview-img__c",src:u.url,onClick:k=>e.fileItemClick(u)},null,8,Ne)):(r(),d("view",Te,[y("view",{class:"nut-uploader__preview-img__file__name",onClick:k=>e.fileItemClick(u)},[y("view",Me,w(u.name),1)],8,He)])),y("view",Ve,w(u.name),1)])):e.listType=="list"?(r(),d("view",Xe,[y("view",{class:_(["nut-uploader__preview-img__file__name",[u.status]]),onClick:k=>e.fileItemClick(u)},[B($,{class:"nut-uploader__preview-img__file__link"}),y("view",Oe,w(u.name),1),e.isDeletable?(r(),S(N,{key:0,color:"#808080",class:"nut-uploader__preview-img__file__del",onClick:k=>e.onDelete(u,z)},null,8,["onClick"])):f("",!0)],10,Ie),u.status=="uploading"?(r(),S(T,{key:0,size:"small",percentage:u.percentage,"stroke-color":"linear-gradient(270deg, rgba(18,126,255,1) 0%,rgba(32,147,255,1) 32.815625%,rgba(13,242,204,1) 100%)","show-text":!1},null,8,["percentage"])):f("",!0)])):f("",!0)],2)}),128)),e.listType=="picture"&&!e.$slots.default&&Number(e.maximum)-e.fileList.length?(r(),d("view",{key:1,class:_(["nut-uploader__upload",[e.listType]])},[L(e.$slots,"upload-icon",{},()=>[B(H,{color:"#808080"})]),(r(),S(A(e.renderInput),{onChange:e.onChange},null,40,["onChange"]))],2)):f("",!0)])}const Ee=j(De,[["render",Ae]]),Re=e=>e,Qe=Re(Ee);export{Qe as U};
