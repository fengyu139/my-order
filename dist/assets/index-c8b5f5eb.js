import{Z as R,r as V,b as E,c as h,a as B,L as C,M as L,O as M,P as j,H as _,Q as I,o as y,e as Y,f as m,n as v,h as z,l as f,G,g as d,$ as Q}from"./index-3f55ee30.js";import{u as Z}from"./index-I8tfW3Kf-71407950.js";import{p as q}from"./pxCheck-DN6FYV6q-3938f682.js";import{u as x}from"./index-BvmDLUYP-2e4d003f.js";var A=Object.defineProperty,F=Object.defineProperties,J=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,P=(e,s,l)=>s in e?A(e,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[s]=l,W=(e,s)=>{for(var l in s||(s={}))K.call(s,l)&&P(e,l,s[l]);if(S)for(var l of S(s))U.call(s,l)&&P(e,l,s[l]);return e},X=(e,s)=>F(e,J(s));const{create:ee}=M("pull-refresh"),te="NutPullRefresh",se=ee({props:{modelValue:{type:Boolean,default:!1},pullingTxt:{type:String,default:""},loosingTxt:{type:String,default:""},loadingTxt:{type:String,default:""},completeTxt:{type:String,default:""},headHeight:{type:[String,Number],default:50},pullDistance:{type:[String,Number],default:50},duration:{type:[String,Number],default:.3},completeDuration:{type:Number,default:0}},emits:["change","refresh","update:modelValue"],components:{Loading:R},setup(e,{emit:s,slots:l}){const u=j(te),r=Z(),g=V(),i=x(g),t=E({isPullRefresh:!1,distance:0,status:"normal"}),T=h(()=>{switch(t.status){case"pulling":return l.pulling?"":e.pullingTxt||u("pulling");case"loosing":return l.loosing?"":e.loosingTxt||u("loosing");case"loading":return l.loading?"":e.loadingTxt||u("loading");case"complete":return l.complete?"":e.completeTxt||u("complete")}return""}),D=h(()=>({transitionDuration:`${e.duration}s`,transform:t.distance?`translate3d(0,${t.distance}px, 0)`:""})),O=h(()=>{const o={};return e.headHeight!=50&&(o.height=q(e.headHeight)),o}),$=o=>{const a=+(e.pullDistance||e.headHeight);let c=o;return o>a&&(o<a*2?c=(o+a)/2:c=a+o/4),Math.round(c)},n=(o,a,c)=>{const k=+(e.pullDistance||e.headHeight);t.distance=o,a?t.status="loading":c?t.status="complete":o===0?t.status="normal":o<k?t.status="pulling":t.status="loosing",s("change",{status:t.status,distance:o})},p=()=>t.status!=="loading"&&t.status!=="complete",b=()=>i.value==window?Q()==0:i.value&&i.value.scrollTop==0,w=o=>{p()&&(b()?(r.start(o),t.isPullRefresh=!0):(t.distance=0,t.isPullRefresh=!1))},H=o=>{if(p()){r.move(o);const{deltaY:a}=r;r.isVertical()&&a.value>0&&t.isPullRefresh&&(o.preventDefault(),n($(a.value)))}},N=()=>{t.isPullRefresh&&p()&&r.deltaY.value&&(t.status==="loosing"?(n(+e.headHeight,!0),s("update:modelValue",!0),_(()=>s("refresh"))):n(0)),setTimeout(()=>{r.reset()},0)};return B(()=>e.modelValue,o=>{o?n(+e.headHeight,!0):(e.completeDuration===0&&n(0),n(+e.headHeight,!1,!0),setTimeout(()=>{n(0)},e.completeDuration))}),X(W({scroller:g},C(t)),{touchStart:w,touchMove:H,touchEnd:N,getStyle:D,translate:u,slots:l,getHeightStyle:O,getPullStatus:T})}}),oe={class:"nut-pull-refresh-container-topbox-text"};function le(e,s,l,u,r,g){const i=I("Loading");return y(),Y("div",{ref:"scroller",class:"nut-pull-refresh",onTouchstart:s[0]||(s[0]=(...t)=>e.touchStart&&e.touchStart(...t)),onTouchmove:s[1]||(s[1]=(...t)=>e.touchMove&&e.touchMove(...t)),onTouchend:s[2]||(s[2]=(...t)=>e.touchEnd&&e.touchEnd(...t))},[m("div",{class:"nut-pull-refresh-container",style:v(e.getStyle)},[m("div",{class:"nut-pull-refresh-container-topbox",style:v(e.getHeightStyle)},[e.status=="loading"&&!e.slots.loading?(y(),z(i,{key:0,class:"nut-icon-loading nut-pull-refresh-container-topbox-icon"})):f("",!0),m("div",oe,G(e.getPullStatus),1),e.status=="pulling"?d(e.$slots,"pulling",{key:1}):f("",!0),e.status=="loosing"?d(e.$slots,"loosing",{key:2}):f("",!0),e.status=="loading"?d(e.$slots,"loading",{key:3}):f("",!0),e.status=="complete"?d(e.$slots,"complete",{key:4}):f("",!0)],4),d(e.$slots,"default")],4)],544)}const ie=L(se,[["render",le]]);export{ie as i};
