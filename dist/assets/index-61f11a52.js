import{Y as R,r as V,a as N,c as d,w as E,L as _,_ as j,b as B,h as L,o as y,d as M,e as v,n as P,j as I,k as f,H as Y,f as g,l as z,I as x,Z}from"./index-6ced0f24.js";import{u as q}from"./index-7a7385e4-9157872d.js";import{p as A}from"./pxCheck-c6b9f6b7-e26267bf.js";import{u as F}from"./index-97b44e6c-3d4d50cd.js";var G=Object.defineProperty,J=Object.defineProperties,K=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,T=(e,t,l)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,W=(e,t)=>{for(var l in t||(t={}))Q.call(t,l)&&T(e,l,t[l]);if(S)for(var l of S(t))U.call(t,l)&&T(e,l,t[l]);return e},X=(e,t)=>J(e,K(t));const{componentName:ee,create:te,translate:p}=B("pull-refresh"),se=te({props:{modelValue:{type:Boolean,default:!1},pullingTxt:{type:String,default:p("pulling")},loosingTxt:{type:String,default:p("loosing")},loadingTxt:{type:String,default:p("loading")},headHeight:{type:[String,Number],default:50},pullDistance:{type:[String,Number],default:50},duration:{type:[String,Number],default:.3}},emits:["change","refresh","update:modelValue"],components:{Loading:R},setup(e,{emit:t,slots:l}){const r=q(),h=V(),c=F(h),o=N({isPullRefresh:!1,distance:0,status:"normal"}),n=d(()=>({[ee]:!0})),w=d(()=>{switch(o.status){case"pulling":return l.pulling?"":e.pullingTxt;case"loosing":return l.loosing?"":e.loosingTxt;case"loading":return l.loading?"":e.loadingTxt}return""}),O=d(()=>({transitionDuration:`${e.duration}s`,transform:o.distance?`translate3d(0,${o.distance}px, 0)`:""})),b=d(()=>{const s={};return e.headHeight!=50&&(s.height=A(e.headHeight)),s}),D=s=>{const a=+(e.pullDistance||e.headHeight);let i=s;return s>a&&(s<a*2?i=(s+a)/2:i=a+s/4),Math.round(i)},u=(s,a)=>{const i=+(e.pullDistance||e.headHeight);o.distance=s,a?o.status="loading":s===0?o.status="normal":s<i?o.status="pulling":o.status="loosing",t("change",{status:o.status,distance:s})},m=()=>o.status!=="loading"&&o.status!=="complete",$=()=>c.value==window?Z()==0:c.value&&c.value.scrollTop==0,H=s=>{m()&&($()?(r.start(s),o.isPullRefresh=!0):(o.distance=0,o.isPullRefresh=!1))},k=s=>{if(m()){r.move(s);const{deltaY:a}=r;r.isVertical()&&a.value>0&&o.isPullRefresh&&(s.preventDefault(),u(D(a.value)))}},C=()=>{o.isPullRefresh&&m()&&r.deltaY.value&&(o.status==="loosing"?(u(+e.headHeight,!0),t("update:modelValue",!0),x(()=>t("refresh"))):u(0)),setTimeout(()=>{r.reset()},0)};return E(()=>e.modelValue,s=>{s?u(+e.headHeight,!0):u(0)}),X(W({classes:n,scroller:h},_(o)),{touchStart:H,touchMove:k,touchEnd:C,getStyle:O,translate:p,slots:l,getHeightStyle:b,getPullStatus:w})}}),oe={class:"nut-pull-refresh-container-topbox-text"};function le(e,t,l,r,h,c){const o=L("Loading");return y(),M("div",{ref:"scroller",class:z(e.classes),onTouchstart:t[0]||(t[0]=(...n)=>e.touchStart&&e.touchStart(...n)),onTouchmove:t[1]||(t[1]=(...n)=>e.touchMove&&e.touchMove(...n)),onTouchend:t[2]||(t[2]=(...n)=>e.touchEnd&&e.touchEnd(...n))},[v("div",{class:"nut-pull-refresh-container",style:P(e.getStyle)},[v("div",{class:"nut-pull-refresh-container-topbox",style:P(e.getHeightStyle)},[e.status=="loading"&&!e.slots.loading?(y(),I(o,{key:0,class:"nut-icon-loading nut-pull-refresh-container-topbox-icon"})):f("",!0),v("div",oe,Y(e.getPullStatus),1),e.status=="pulling"?g(e.$slots,"pulling",{key:1}):f("",!0),e.status=="loosing"?g(e.$slots,"loosing",{key:2}):f("",!0),e.status=="loading"?g(e.$slots,"loading",{key:3}):f("",!0)],4),g(e.$slots,"default")],4)],34)}const ae=j(se,[["render",le]]),re=e=>e,de=re(ae);export{de as P};
