import{J as M,K as V,o as n,d,l as _,n as v,e as y,a6 as j,c as F,_ as E,b as R,h as k,H as w,k as f,f as L,s as U,aD as q,$ as W,r as I,w as Q,V as J,aE as K,j as S,al as O,F as A,C as Z,a as G,M as Y}from"./index-41545bf3.js";import{g as x}from"./Checked-1a6cc4a9.js";const ee=V("del"),te=y("path",{d:"M668.444 1024H355.556c-142.223 0-256-113.778-256-256V170.667h824.888V768c0 142.222-113.777 256-256 256zM184.89 256v512c0 93.867 76.8 170.667 170.667 170.667h312.888c93.867 0 170.667-76.8 170.667-170.667V256H184.89zm753.778 0H85.333c-22.755 0-42.666-19.911-42.666-42.667s19.91-42.666 42.666-42.666h853.334c22.755 0 42.666 19.91 42.666 42.666S961.423 256 938.667 256zM625.777 85.333H398.223c-22.755 0-42.666-19.91-42.666-42.666S375.466 0 398.222 0h227.556c22.755 0 42.666 19.911 42.666 42.667s-19.91 42.666-42.666 42.666z",fill:"currentColor","fill-opacity":"0.9"},null,-1),se=[te];function ae(e,l,s,a,p,h){return n(),d("svg",{class:_(e.classes),style:v(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},se,6)}const le=M(ee,[["render",ae]]),oe=V("link"),ne=y("path",{d:"M313.034 1004.045c-66.848 0-124.402-24.156-170.798-70.577l-40.854-40.829C54.96 846.218 28.966 783.097 30.83 714.411c3.702-66.85 31.56-131.808 79.819-180.12l137.4-137.373c14.86-14.861 40.855-14.861 55.69 0 14.86 14.861 16.725 38.99 0 55.69l-137.348 137.4a187.47 187.47 0 0 0-55.69 126.24c-1.864 46.422 14.835 89.115 46.396 120.675l40.855 40.855c31.56 31.56 74.253 48.286 120.674 46.421 46.421-1.838 92.843-22.291 126.24-55.69l137.4-137.4c14.862-14.86 40.856-14.86 55.69 0 14.862 14.862 14.862 40.856 0 55.69l-137.4 137.427c-48.285 48.259-113.27 76.117-180.118 79.82a5.645 5.645 0 0 0-7.405 0zm475.294-382.477c-11.133 0-18.563-3.702-27.832-12.997-14.86-14.861-14.86-40.855 0-55.69l115.082-115.108a187.47 187.47 0 0 0 55.716-126.267c1.838-46.395-14.861-89.114-46.421-120.674l-40.855-40.855c-64.985-64.959-176.364-61.257-246.915 9.294L478.266 278.108c-14.835 14.835-40.829 14.835-55.69 0-14.86-14.861-14.86-40.855 0-55.716l118.81-118.81C643.524 1.444 803.163-2.232 899.734 94.287l40.829 40.855c46.421 46.421 72.415 109.541 70.55 178.228-3.702 66.85-31.56 131.807-79.819 180.093L816.186 608.571c-7.43 7.43-18.563 11.133-27.858 12.997zm-332.327-1.864c-11.16 0-18.564-3.702-27.832-12.997-14.888-14.835-14.888-40.829 0-55.69l148.506-148.532c14.861-14.862 40.855-14.862 55.69 0 14.861 14.86 14.861 40.854 0 55.69L483.832 606.706c-7.404 7.43-18.563 11.159-27.831 12.997z",fill:"currentColor","fill-opacity":"0.9"},null,-1),re=[ne];function ie(e,l,s,a,p,h){return n(),d("svg",{class:_(e.classes),style:v(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},re,6)}const ue=M(oe,[["render",ie]]),ce=V("photograph"),de=y("path",{d:"M570.514 789.943c-119.954 0-219.428-99.474-219.428-219.429s99.474-219.428 219.428-219.428 219.429 99.474 219.429 219.428-99.474 219.429-219.429 219.429zm0-351.086c-73.143 0-131.657 58.514-131.657 131.657s58.514 131.657 131.657 131.657 131.657-58.514 131.657-131.657-58.514-131.657-131.657-131.657zM877.714 1024h-614.4C117.03 1024 0 906.971 0 760.686V380.343c0-146.286 117.029-263.314 263.314-263.314h32.183c0-2.926 2.926-8.778 2.926-11.703C315.977 43.886 374.49 0 438.857 0h263.314c70.218 0 128.732 49.737 143.36 117.029h32.183c146.286 0 263.315 117.028 263.315 263.314v380.343C1141.029 906.97 1024 1024 877.714 1024zm-614.4-819.2c-96.548 0-175.543 78.994-175.543 175.543v380.343c0 96.548 78.995 175.543 175.543 175.543h614.4c96.549 0 175.543-78.995 175.543-175.543V380.343c0-96.549-78.994-175.543-175.543-175.543H819.2c-32.183 0-58.514-26.331-58.514-58.514S734.354 87.77 702.17 87.77H438.857c-26.331 0-49.737 17.555-55.588 40.96-2.926 5.852-2.926 11.703-2.926 17.555 0 32.183-26.332 58.514-58.514 58.514h-58.515zm-87.771 160.914a73.143 73.143 0 1 0 146.286 0 73.143 73.143 0 1 0-146.286 0Z",fill:"currentColor","fill-opacity":"0.9"},null,-1),pe=[de];function he(e,l,s,a,p,h){return n(),d("svg",{class:_(e.classes),style:v(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1141 1024",role:"presentation"},pe,6)}const ge=M(ce,[["render",he]]),{create:fe}=R("progress"),me=fe({components:{Checked:x},props:{percentage:{type:[Number,String],default:0,required:!0},size:{type:String,default:"base"},status:{type:String,default:"text"},strokeWidth:{type:[Number,String],default:""},textInside:{type:Boolean,default:!1},showText:{type:Boolean,default:!0},strokeColor:{type:String,default:""},textColor:{type:String,default:""},textBackground:{type:String,default:""},isShowPercentage:{type:Boolean,default:!0}},setup(e){const l=!!j().default,s=F(()=>{if(e.strokeWidth)return e.strokeWidth+"px"}),a=F(()=>Number(e.percentage)>=100?100:Number(e.percentage)),p=F(()=>({width:a.value+"%",background:e.strokeColor||""})),h=F(()=>({color:e.textColor||""}));return{height:s,percentage:a,bgStyle:p,textStyle:h,slotDefault:l}}}),ye={class:"nut-progress"};function ve(e,l,s,a,p,h){const C=k("Checked");return n(),d("div",ye,[y("div",{class:_(["nut-progress-outer",[e.showText&&!e.textInside?"nut-progress-outer-part":"",e.size?"nut-progress-"+e.size:""]]),style:v({height:e.height})},[y("div",{class:_(["nut-progress-inner",e.status==="active"?"nut-active":""]),style:v(e.bgStyle)},null,6),e.showText&&e.textInside&&!e.slotDefault?(n(),d("div",{key:0,class:"nut-progress-text nut-progress-insidetext",style:v({lineHeight:e.height,left:`${e.percentage}%`,transform:`translate(-${+e.percentage}%,-50%)`,background:e.textBackground||e.strokeColor})},[y("span",{style:v(e.textStyle)},w(e.percentage)+w(e.isShowPercentage?"%":""),5)],4)):f("",!0),e.showText&&e.textInside&&e.slotDefault?(n(),d("div",{key:1,class:"nut-progress-slot",style:v({position:"absolute",top:"50%",left:`${e.percentage}%`,transform:`translate(-${+e.percentage}%,-50%)`})},[L(e.$slots,"default")],4)):f("",!0)],6),e.showText&&!e.textInside?(n(),d("div",{key:0,class:"nut-progress-text",style:v({lineHeight:e.height})},[e.status==="text"||e.status==="active"?(n(),d("span",{key:0,style:v(e.textStyle)},w(e.percentage)+w(e.isShowPercentage?"%":""),5)):e.status==="icon"?L(e.$slots,"icon-name",{key:1},()=>[U(C,{width:"15px",height:"15px",color:"#439422"})]):f("",!0)],4)):f("",!0)])}const we=E(me,[["render",ve]]);var _e=Object.defineProperty,ke=(e,l,s)=>l in e?_e(e,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[l]=s,r=(e,l,s)=>(ke(e,typeof l!="symbol"?l+"":l,s),s);class Ce{constructor(){r(this,"url",""),r(this,"name","file"),r(this,"fileType","image"),r(this,"formData"),r(this,"sourceFile"),r(this,"method","post"),r(this,"xhrState",200),r(this,"timeout",30*1e3),r(this,"headers",{}),r(this,"withCredentials",!1),r(this,"onStart"),r(this,"taroFilePath"),r(this,"onProgress"),r(this,"onSuccess"),r(this,"onFailure"),r(this,"beforeXhrUpload")}}class be{constructor(l){r(this,"options"),this.options=l}upload(){var l;const s=this.options,a=new XMLHttpRequest;if(a.timeout=s.timeout,a.upload){a.upload.addEventListener("progress",p=>{var h;(h=s.onProgress)==null||h.call(s,p,s)},!1),a.onreadystatechange=()=>{var p,h;a.readyState===4&&(a.status==s.xhrState?(p=s.onSuccess)==null||p.call(s,a.responseText,s):(h=s.onFailure)==null||h.call(s,a.responseText,s))},a.withCredentials=s.withCredentials,a.open(s.method,s.url,!0);for(const[p,h]of Object.entries(s.headers))a.setRequestHeader(p,h);(l=s.onStart)==null||l.call(s,s),s.beforeXhrUpload?s.beforeXhrUpload(a,s):a.send(s.formData)}else console.warn("浏览器不支持 XMLHttpRequest")}}class Se{constructor(){r(this,"status","ready"),r(this,"message",""),r(this,"uid",new Date().getTime().toString()),r(this,"name"),r(this,"url"),r(this,"type"),r(this,"path"),r(this,"percentage",0),r(this,"formData",{})}}const{create:$e}=R("uploader"),Le="NutUploader",De=$e({components:{NutProgress:we,Photograph:ge,Failure:q,Loading:W,Del:le,Link:ue},props:{name:{type:String,default:"file"},url:{type:String,default:""},timeout:{type:[Number,String],default:1e3*30},fileList:{type:Array,default:()=>[]},isPreview:{type:Boolean,default:!0},listType:{type:String,default:"picture"},isDeletable:{type:Boolean,default:!0},method:{type:String,default:"post"},capture:{type:Boolean,default:!1},maximize:{type:[Number,String],default:Number.MAX_VALUE},maximum:{type:[Number,String],default:1},clearInput:{type:Boolean,default:!0},accept:{type:String,default:"*"},headers:{type:Object,default:{}},data:{type:Object,default:{}},xhrState:{type:[Number,String],default:200},withCredentials:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autoUpload:{type:Boolean,default:!0},beforeUpload:{type:Function,default:null},beforeXhrUpload:{type:Function,default:null},beforeDelete:{type:Function,default:()=>!0},onChange:{type:Function}},emits:["start","progress","oversize","success","failure","change","delete","update:fileList","fileItemClick"],setup(e,{emit:l}){const s=Y(Le),a=I(e.fileList),p=I([]);Q(()=>e.fileList,()=>{a.value=e.fileList});const h=()=>{let t={class:"nut-uploader__input",type:"file",accept:e.accept,multiple:e.multiple,name:e.name,disabled:e.disabled};return e.capture&&(t.capture="camera",t.accept||(t.accept="image/*")),J("input",t)},C=t=>{t.value=""},B=t=>{l("fileItemClick",{fileItem:t})},N=(t,i)=>{const c=new Ce;c.url=e.url,c.formData=t.formData,c.timeout=e.timeout*1,c.method=e.method,c.xhrState=e.xhrState,c.headers=e.headers,c.withCredentials=e.withCredentials,c.beforeXhrUpload=e.beforeXhrUpload;try{c.sourceFile=t.formData.get(e.name)}catch(o){console.warn("[NutUI] <Uploader> formData.get(name)",o)}c.onStart=o=>{t.status="ready",t.message=s("readyUpload"),$(i),l("start",o)},c.onProgress=(o,g)=>{t.status="uploading",t.message=s("uploading"),t.percentage=(o.loaded/o.total*100).toFixed(0),l("progress",{event:o,option:g,percentage:t.percentage})},c.onSuccess=(o,g)=>{t.status="success",t.message=s("success"),l("success",{responseText:o,option:g,fileItem:t}),l("update:fileList",a.value)},c.onFailure=(o,g)=>{t.status="error",t.message=s("error"),l("failure",{responseText:o,option:g,fileItem:t})};let m=new be(c);e.autoUpload?m.upload():p.value.push(new Promise(o=>{o(m)}))},$=(t=-1)=>{t>-1?p.value.splice(t,1):(p.value=[],a.value=[],l("update:fileList",a.value))},P=()=>{Promise.all(p.value).then(t=>{t.forEach(i=>i.upload())})},T=t=>{t.forEach((i,c)=>{const m=new FormData;for(const[g,H]of Object.entries(e.data))m.append(g,H);m.append(e.name,i);const o=G(new Se);if(o.name=i.name,o.status="ready",o.type=i.type,o.formData=m,o.message=s("waitingUpload"),N(o,c),e.isPreview&&i.type.includes("image")){const g=new FileReader;g.onload=H=>{o.url=H.target.result,a.value.push(o)},g.readAsDataURL(i)}else a.value.push(o)})},u=t=>{const i=e.maximum*1,c=e.maximize*1,m=new Array;t=t.filter(g=>g.size>c?(m.push(g),!1):!0),m.length&&l("oversize",m);let o=t.length+a.value.length;return o>i&&t.splice(t.length-(o-i)),t},D=(t,i)=>{a.value.splice(i,1),l("delete",{file:t,fileList:a.value,index:i})},z=(t,i)=>{$(i),K(e.beforeDelete,{args:[t,a.value],done:()=>D(t,i)})},b=t=>{if(e.disabled)return;const i=t.target;let{files:c}=i;e.beforeUpload?e.beforeUpload(c).then(m=>X(m)):X(c),l("change",{fileList:a.value,event:t}),e.clearInput&&C(i)},X=t=>{const i=u(new Array().slice.call(t));T(i)};return{onChange:b,onDelete:z,fileList:a,fileItemClick:B,clearUploadQueue:$,submit:P,renderInput:h}}}),ze={class:"nut-uploader"},Fe={key:0,class:"nut-uploader__slot"},Ue={key:0,class:"nut-uploader__preview-img"},Be={key:0,class:"nut-uploader__preview__progress"},Ne={class:"nut-uploader__preview__progress__msg"},Pe=["onClick"],Te=["src","onClick"],He={key:3,class:"nut-uploader__preview-img__file"},Me=["onClick"],Ve={class:"file__name_tips"},Xe={class:"tips"},Ie={key:1,class:"nut-uploader__preview-list"},Oe=["onClick"],Ae={class:"file__name_tips"};function Ee(e,l,s,a,p,h){const C=k("Failure"),B=k("Loading"),N=k("Link"),$=k("Del"),P=k("nut-progress"),T=k("Photograph");return n(),d("view",ze,[e.$slots.default?(n(),d("view",Fe,[L(e.$slots,"default"),Number(e.maximum)-e.fileList.length?(n(),S(O(e.renderInput),{key:0,onChange:e.onChange},null,40,["onChange"])):f("",!0)])):f("",!0),(n(!0),d(A,null,Z(e.fileList,(u,D)=>{var z;return n(),d("view",{key:u.uid,class:_(["nut-uploader__preview",[e.listType]])},[e.listType=="picture"&&!e.$slots.default?(n(),d("view",Ue,[u.status!="success"?(n(),d("view",Be,[u.status!="ready"?(n(),d(A,{key:0},[u.status=="error"?(n(),S(C,{key:0,color:"#fff"})):(n(),S(B,{key:1,name:"loading",color:"#fff"}))],64)):f("",!0),y("view",Ne,w(u.message),1)])):f("",!0),e.isDeletable?(n(),d("view",{key:1,class:"close",onClick:b=>e.onDelete(u,D)},[L(e.$slots,"delete-icon",{},()=>[U(C)])],8,Pe)):f("",!0),(z=u==null?void 0:u.type)!=null&&z.includes("image")&&u.url?(n(),d("img",{key:2,class:"nut-uploader__preview-img__c",src:u.url,onClick:b=>e.fileItemClick(u)},null,8,Te)):(n(),d("view",He,[y("view",{class:"nut-uploader__preview-img__file__name",onClick:b=>e.fileItemClick(u)},[y("view",Ve,w(u.name),1)],8,Me)])),y("view",Xe,w(u.name),1)])):e.listType=="list"?(n(),d("view",Ie,[y("view",{class:_(["nut-uploader__preview-img__file__name",[u.status]]),onClick:b=>e.fileItemClick(u)},[U(N,{class:"nut-uploader__preview-img__file__link"}),y("view",Ae,w(u.name),1),e.isDeletable?(n(),S($,{key:0,color:"#808080",class:"nut-uploader__preview-img__file__del",onClick:b=>e.onDelete(u,D)},null,8,["onClick"])):f("",!0)],10,Oe),u.status=="uploading"?(n(),S(P,{key:0,size:"small",percentage:u.percentage,"stroke-color":"linear-gradient(270deg, rgba(18,126,255,1) 0%,rgba(32,147,255,1) 32.815625%,rgba(13,242,204,1) 100%)","show-text":!1},null,8,["percentage"])):f("",!0)])):f("",!0)],2)}),128)),e.listType=="picture"&&!e.$slots.default&&Number(e.maximum)-e.fileList.length?(n(),d("view",{key:1,class:_(["nut-uploader__upload",[e.listType]])},[L(e.$slots,"upload-icon",{},()=>[U(T,{color:"#808080"})]),(n(),S(O(e.renderInput),{onChange:e.onChange},null,40,["onChange"]))],2)):f("",!0)])}const qe=E(De,[["render",Ee]]);export{qe as i};
