import{I as H,J as I,o as n,e as h,m as k,n as y,f as _,d as q,w as Q,c as F,G as w,l as m,g as P,t as U,u as x,aG as G,Z,ah as J,r as V,a as K,M as Y,O as ee,W as te,aH as se,Q as C,h as $,ak as X,F as j,C as ae,j as le,b as re,P as oe}from"./index-3f55ee30.js";import{g as ne}from"./Checked-28f36dec.js";import{u as ie}from"./common-BH7uB7Cn-ad9c9445.js";const ue=I("del"),ce=_("path",{d:"M668.444 1024H355.556c-142.223 0-256-113.778-256-256V170.667h824.888V768c0 142.222-113.777 256-256 256zM184.89 256v512c0 93.867 76.8 170.667 170.667 170.667h312.888c93.867 0 170.667-76.8 170.667-170.667V256H184.89zm753.778 0H85.333c-22.755 0-42.666-19.911-42.666-42.667s19.91-42.666 42.666-42.666h853.334c22.755 0 42.666 19.91 42.666 42.666S961.423 256 938.667 256zM625.777 85.333H398.223c-22.755 0-42.666-19.91-42.666-42.666S375.466 0 398.222 0h227.556c22.755 0 42.666 19.911 42.666 42.667s-19.91 42.666-42.666 42.666z",fill:"currentColor","fill-opacity":"0.9"},null,-1),de=[ce];function pe(e,s,t,l,u,f){return n(),h("svg",{class:k(e.classes),style:y(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},de,6)}const he=H(ue,[["render",pe]]),fe=I("link"),ge=_("path",{d:"M313.034 1004.045c-66.848 0-124.402-24.156-170.798-70.577l-40.854-40.829C54.96 846.218 28.966 783.097 30.83 714.411c3.702-66.85 31.56-131.808 79.819-180.12l137.4-137.373c14.86-14.861 40.855-14.861 55.69 0 14.86 14.861 16.725 38.99 0 55.69l-137.348 137.4a187.47 187.47 0 0 0-55.69 126.24c-1.864 46.422 14.835 89.115 46.396 120.675l40.855 40.855c31.56 31.56 74.253 48.286 120.674 46.421 46.421-1.838 92.843-22.291 126.24-55.69l137.4-137.4c14.862-14.86 40.856-14.86 55.69 0 14.862 14.862 14.862 40.856 0 55.69l-137.4 137.427c-48.285 48.259-113.27 76.117-180.118 79.82a5.645 5.645 0 0 0-7.405 0zm475.294-382.477c-11.133 0-18.563-3.702-27.832-12.997-14.86-14.861-14.86-40.855 0-55.69l115.082-115.108a187.47 187.47 0 0 0 55.716-126.267c1.838-46.395-14.861-89.114-46.421-120.674l-40.855-40.855c-64.985-64.959-176.364-61.257-246.915 9.294L478.266 278.108c-14.835 14.835-40.829 14.835-55.69 0-14.86-14.861-14.86-40.855 0-55.716l118.81-118.81C643.524 1.444 803.163-2.232 899.734 94.287l40.829 40.855c46.421 46.421 72.415 109.541 70.55 178.228-3.702 66.85-31.56 131.807-79.819 180.093L816.186 608.571c-7.43 7.43-18.563 11.133-27.858 12.997zm-332.327-1.864c-11.16 0-18.564-3.702-27.832-12.997-14.888-14.835-14.888-40.829 0-55.69l148.506-148.532c14.861-14.862 40.855-14.862 55.69 0 14.861 14.86 14.861 40.854 0 55.69L483.832 606.706c-7.404 7.43-18.563 11.159-27.831 12.997z",fill:"currentColor","fill-opacity":"0.9"},null,-1),me=[ge];function ve(e,s,t,l,u,f){return n(),h("svg",{class:k(e.classes),style:y(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},me,6)}const _e=H(fe,[["render",ve]]),ye=I("photograph"),we=_("path",{d:"M570.514 789.943c-119.954 0-219.428-99.474-219.428-219.429s99.474-219.428 219.428-219.428 219.429 99.474 219.429 219.428-99.474 219.429-219.429 219.429zm0-351.086c-73.143 0-131.657 58.514-131.657 131.657s58.514 131.657 131.657 131.657 131.657-58.514 131.657-131.657-58.514-131.657-131.657-131.657zM877.714 1024h-614.4C117.03 1024 0 906.971 0 760.686V380.343c0-146.286 117.029-263.314 263.314-263.314h32.183c0-2.926 2.926-8.778 2.926-11.703C315.977 43.886 374.49 0 438.857 0h263.314c70.218 0 128.732 49.737 143.36 117.029h32.183c146.286 0 263.315 117.028 263.315 263.314v380.343C1141.029 906.97 1024 1024 877.714 1024zm-614.4-819.2c-96.548 0-175.543 78.994-175.543 175.543v380.343c0 96.548 78.995 175.543 175.543 175.543h614.4c96.549 0 175.543-78.995 175.543-175.543V380.343c0-96.549-78.994-175.543-175.543-175.543H819.2c-32.183 0-58.514-26.331-58.514-58.514S734.354 87.77 702.17 87.77H438.857c-26.331 0-49.737 17.555-55.588 40.96-2.926 5.852-2.926 11.703-2.926 17.555 0 32.183-26.332 58.514-58.514 58.514h-58.515zm-87.771 160.914a73.143 73.143 0 1 0 146.286 0 73.143 73.143 0 1 0-146.286 0Z",fill:"currentColor","fill-opacity":"0.9"},null,-1),ke=[we];function be(e,s,t,l,u,f){return n(),h("svg",{class:k(e.classes),style:y(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1141 1024",role:"presentation"},ke,6)}const Ce=H(ye,[["render",be]]);var $e=Object.defineProperty,Se=Object.defineProperties,Pe=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,Le=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,R=(e,s,t)=>s in e?$e(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,ze=(e,s)=>{for(var t in s||(s={}))Le.call(s,t)&&R(e,t,s[t]);if(E)for(var t of E(s))De.call(s,t)&&R(e,t,s[t]);return e},Fe=(e,s)=>Se(e,Pe(s));const Ue={class:"nut-progress"},A=q(Fe(ze({},{name:"NutProgress"}),{__name:"progress",props:{percentage:{default:0},size:{default:"base"},status:{default:"text"},strokeWidth:{},textInside:{type:Boolean,default:!1},showText:{type:Boolean,default:!0},strokeColor:{},textColor:{},textBackground:{},isShowPercentage:{type:Boolean,default:!0}},setup(e){const s=e,t=F(()=>{if(s.strokeWidth)return s.strokeWidth+"px"}),l=F(()=>Number(s.percentage)>=100?100:Number(s.percentage)),u=F(()=>({width:l.value+"%",background:s.strokeColor||""})),f=F(()=>({color:s.textColor||""}));return(r,L)=>(n(),h("div",Ue,[_("div",{class:k(["nut-progress-outer",[r.showText&&!r.textInside?"nut-progress-outer-part":"",r.size?"nut-progress-"+r.size:""]]),style:y({height:t.value})},[_("div",{class:k(["nut-progress-inner",r.status==="active"?"nut-active":""]),style:y(u.value)},null,6),r.showText&&r.textInside&&!r.$slots.default?(n(),h("div",{key:0,class:"nut-progress-text nut-progress-insidetext",style:y({lineHeight:t.value,left:`${l.value}%`,transform:`translate(-${+l.value}%,-50%)`,background:r.textBackground||r.strokeColor})},[_("span",{style:y(f.value)},w(l.value)+w(r.isShowPercentage?"%":""),5)],4)):m("",!0),r.showText&&r.textInside&&r.$slots.default?(n(),h("div",{key:1,class:"nut-progress-slot",style:y({position:"absolute",top:"50%",left:`${l.value}%`,transform:`translate(-${+l.value}%,-50%)`})},[P(r.$slots,"default")],4)):m("",!0)],6),r.showText&&!r.textInside?(n(),h("div",{key:0,class:"nut-progress-text",style:y({lineHeight:t.value})},[r.status==="text"||r.status==="active"?(n(),h("span",{key:0,style:y(f.value)},w(l.value)+w(r.isShowPercentage?"%":""),5)):r.status==="icon"?P(r.$slots,"icon-name",{key:1},()=>[U(x(ne),{width:"15px",height:"15px",color:"#439422"})]):m("",!0)],4)):m("",!0)]))}}));Q(A);var Be=Object.defineProperty,Oe=(e,s,t)=>s in e?Be(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,i=(e,s,t)=>Oe(e,typeof s!="symbol"?s+"":s,t);class Ne{constructor(){i(this,"url",""),i(this,"name","file"),i(this,"fileType","image"),i(this,"formData"),i(this,"sourceFile"),i(this,"method","post"),i(this,"xhrState",200),i(this,"timeout",30*1e3),i(this,"headers",{}),i(this,"withCredentials",!1),i(this,"onStart"),i(this,"taroFilePath"),i(this,"onProgress"),i(this,"onSuccess"),i(this,"onFailure"),i(this,"beforeXhrUpload")}}class Te{constructor(s){i(this,"options"),this.options=s}upload(){var s;const t=this.options,l=new XMLHttpRequest;if(l.timeout=t.timeout,l.upload){l.upload.addEventListener("progress",u=>{var f;(f=t.onProgress)==null||f.call(t,u,t)},!1),l.onreadystatechange=()=>{var u,f;l.readyState===4&&(l.status==t.xhrState?(u=t.onSuccess)==null||u.call(t,l.responseText,t):(f=t.onFailure)==null||f.call(t,l.responseText,t))},l.withCredentials=t.withCredentials,l.open(t.method,t.url,!0);for(const[u,f]of Object.entries(t.headers))l.setRequestHeader(u,f);(s=t.onStart)==null||s.call(t,t),t.beforeXhrUpload?t.beforeXhrUpload(l,t):l.send(t.formData)}else console.warn("浏览器不支持 XMLHttpRequest")}}class He{constructor(){i(this,"status","ready"),i(this,"message",""),i(this,"uid",new Date().getTime().toString()),i(this,"name"),i(this,"url"),i(this,"type"),i(this,"path"),i(this,"percentage",0),i(this,"formData",{})}}const{create:Ie}=ee("uploader"),Me="NutUploader",Ve=Ie({components:{NutProgress:A,Photograph:Ce,Failure:G,Loading:Z,Del:he,Link:_e},props:{name:{type:String,default:"file"},url:{type:String,default:""},timeout:{type:[Number,String],default:1e3*30},fileList:{type:Array,default:()=>[]},isPreview:{type:Boolean,default:!0},listType:{type:String,default:"picture"},isDeletable:{type:Boolean,default:!0},method:{type:String,default:"post"},capture:{type:Boolean,default:!1},maximize:{type:[Number,String],default:Number.MAX_VALUE},maximum:{type:[Number,String],default:1},clearInput:{type:Boolean,default:!0},accept:{type:String,default:"*"},headers:{type:Object,default:{}},data:{type:Object,default:{}},xhrState:{type:[Number,String],default:200},withCredentials:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autoUpload:{type:Boolean,default:!0},beforeUpload:{type:Function,default:null},beforeXhrUpload:{type:Function,default:null},beforeDelete:{type:Function,default:()=>!0},onChange:{type:Function}},emits:["start","progress","oversize","success","failure","change","delete","update:fileList","fileItemClick"],setup(e,{emit:s}){const t=ie(J(e,"disabled")),l=oe(Me),u=V(e.fileList),f=V([]);K(()=>e.fileList,()=>{u.value=e.fileList});const r=()=>{let a={class:"nut-uploader__input",type:"file",accept:e.accept,multiple:e.multiple,name:e.name,disabled:t.value};return e.capture&&(a.capture="camera",a.accept||(a.accept="image/*")),te("input",a)},L=a=>{a.value=""},B=a=>{s("fileItemClick",{fileItem:a})},O=(a,c)=>{const p=new Ne;p.url=e.url,p.formData=a.formData,p.timeout=e.timeout*1,p.method=e.method,p.xhrState=e.xhrState,p.headers=e.headers,p.withCredentials=e.withCredentials,p.beforeXhrUpload=e.beforeXhrUpload;try{p.sourceFile=a.formData.get(e.name)}catch(o){console.warn("[NutUI] <Uploader> formData.get(name)",o)}p.onStart=o=>{a.status="ready",a.message=l("readyUpload"),S(c),s("start",o)},p.onProgress=(o,g)=>{a.status="uploading",a.message=l("uploading"),a.percentage=(o.loaded/o.total*100).toFixed(0),s("progress",{event:o,option:g,percentage:a.percentage})},p.onSuccess=(o,g)=>{a.status="success",a.message=l("success"),s("success",{responseText:o,option:g,fileItem:a}),s("update:fileList",u.value)},p.onFailure=(o,g)=>{a.status="error",a.message=l("error"),s("failure",{responseText:o,option:g,fileItem:a})};let v=new Te(p);e.autoUpload?v.upload():f.value.push(new Promise(o=>{o(v)}))},S=(a=-1)=>{a>-1?f.value.splice(a,1):(f.value=[],u.value=[],s("update:fileList",u.value))},N=()=>{Promise.all(f.value).then(a=>{a.forEach(c=>c.upload())})},d=a=>{a.forEach((c,p)=>{const v=new FormData;for(const[g,T]of Object.entries(e.data))v.append(g,T);v.append(e.name,c);const o=re(new He);if(o.name=c.name,o.status="ready",o.type=c.type,o.formData=v,o.message=l("waitingUpload"),O(o,p),e.isPreview&&c.type.includes("image")){const g=new FileReader;g.onload=T=>{o.url=T.target.result,u.value.push(o)},g.readAsDataURL(c)}else u.value.push(o)})},D=a=>{const c=e.maximum*1,p=e.maximize*1,v=new Array;a=a.filter(g=>g.size>p?(v.push(g),!1):!0),v.length&&s("oversize",v);let o=a.length+u.value.length;return o>c&&a.splice(a.length-(o-c)),a},z=(a,c)=>{u.value.splice(c,1),s("delete",{file:a,fileList:u.value,index:c})},b=(a,c)=>{t.value||(S(c),se(e.beforeDelete,{args:[a,u.value],done:()=>z(a,c)}))},W=a=>{if(e.disabled||t.value)return;const c=a.target;let{files:p}=c;e.beforeUpload?e.beforeUpload(p).then(v=>M(v)):M(p),s("change",{fileList:u.value,event:a}),e.clearInput&&L(c)},M=a=>{const c=D(new Array().slice.call(a));d(c)};return{onChange:W,onDelete:b,fileList:u,fileItemClick:B,clearUploadQueue:S,submit:N,renderInput:r}}}),Xe={class:"nut-uploader"},je={key:0,class:"nut-uploader__slot"},Ee={key:0,class:"nut-uploader__preview-img"},Re={key:0,class:"nut-uploader__preview__progress"},Ae={class:"nut-uploader__preview__progress__msg"},We=["onClick"],qe=["src","onClick"],Qe={key:3,class:"nut-uploader__preview-img__file"},xe=["onClick"],Ge={class:"file__name_tips"},Ze={class:"tips"},Je={key:1,class:"nut-uploader__preview-list"},Ke=["onClick"],Ye={class:"file__name_tips"};function et(e,s,t,l,u,f){const r=C("Failure"),L=C("Loading"),B=C("Link"),O=C("Del"),S=C("nut-progress"),N=C("Photograph");return n(),h("view",Xe,[e.$slots.default?(n(),h("view",je,[P(e.$slots,"default"),Number(e.maximum)-e.fileList.length?(n(),$(X(e.renderInput),{key:0,onChange:e.onChange},null,40,["onChange"])):m("",!0)])):m("",!0),(n(!0),h(j,null,ae(e.fileList,(d,D)=>{var z;return n(),h("view",{key:d.uid,class:k(["nut-uploader__preview",[e.listType]])},[e.listType=="picture"&&!e.$slots.default?(n(),h("view",Ee,[d.status!="success"?(n(),h("view",Re,[d.status!="ready"?(n(),h(j,{key:0},[d.status=="error"?(n(),$(r,{key:0,color:"#fff"})):(n(),$(L,{key:1,name:"loading",color:"#fff"}))],64)):m("",!0),_("view",Ae,w(d.message),1)])):m("",!0),e.isDeletable?(n(),h("view",{key:1,class:"close",onClick:b=>e.onDelete(d,D)},[P(e.$slots,"delete-icon",{},()=>[U(r)])],8,We)):m("",!0),(z=d==null?void 0:d.type)!=null&&z.includes("image")&&d.url?(n(),h("img",{key:2,class:"nut-uploader__preview-img__c",src:d.url,onClick:b=>e.fileItemClick(d)},null,8,qe)):(n(),h("view",Qe,[_("view",{class:"nut-uploader__preview-img__file__name",onClick:b=>e.fileItemClick(d)},[_("view",Ge,w(d.name),1)],8,xe)])),_("view",Ze,w(d.name),1)])):e.listType=="list"?(n(),h("view",Je,[_("view",{class:k(["nut-uploader__preview-img__file__name",[d.status]]),onClick:b=>e.fileItemClick(d)},[U(B,{class:"nut-uploader__preview-img__file__link"}),_("view",Ye,w(d.name),1),e.isDeletable?(n(),$(O,{key:0,color:"#808080",class:"nut-uploader__preview-img__file__del",onClick:le(b=>e.onDelete(d,D),["stop"])},null,8,["onClick"])):m("",!0)],10,Ke),d.status=="uploading"?(n(),$(S,{key:0,size:"small",percentage:d.percentage,"stroke-color":"linear-gradient(270deg, rgba(18,126,255,1) 0%,rgba(32,147,255,1) 32.815625%,rgba(13,242,204,1) 100%)","show-text":!1},null,8,["percentage"])):m("",!0)])):m("",!0)],2)}),128)),e.listType=="picture"&&!e.$slots.default&&Number(e.maximum)-e.fileList.length?(n(),h("view",{key:1,class:k(["nut-uploader__upload",[e.listType]])},[P(e.$slots,"upload-icon",{},()=>[U(N,{color:"#808080"})]),(n(),$(X(e.renderInput),{onChange:e.onChange},null,40,["onChange"]))],2)):m("",!0)])}const lt=Y(Ve,[["render",et]]);export{lt as i};
