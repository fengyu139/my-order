import{J as Me,K as Ie,o as h,d as T,l as D,n as R,e as m,L as x,r as ee,c as y,N as we,I as te,_ as G,b as J,h as W,f as A,s as Ne,k as N,H as V,a as oe,w as j,a9 as re,ai as ue,G as de,a6 as Le,R as Ye,a5 as Ae,F as Be,C as Oe,a0 as H,i as Ve,ak as $e,O as je,P as pe,aF as He,aG as Fe,as as We,T as Ze,$ as be,j as _,t as fe,aE as qe}from"./index-6ced0f24.js";import{u as Ue}from"./index-29892cda-6b6e0bac.js";import{u as ze}from"./index-7a7385e4-9157872d.js";import{u as De,r as ce,z as Ge}from"./raf-729dad54-b3324e41.js";const Je=Ie("left"),Ke=m("path",{d:"M642.973 1005.542 321.912 587.098a123.278 123.278 0 0 1 0-150.17l321.06-418.443a47.182 47.182 0 0 1 74.83 57.422l-321.088 418.47a28.994 28.994 0 0 0 0 35.3l321.088 418.47a47.155 47.155 0 0 1-74.83 57.395",fill:"currentColor","fill-opacity":"0.9"},null,-1),Qe=[Ke];function _e(e,o,n,t,s,c){return h(),T("svg",{class:D(e.classes),style:R(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},Qe,6)}const xe=Me(Je,[["render",_e]]),et=Ie("refresh"),tt=m("path",{d:"M776.374 334.77h181.17l-27.57 149.66-169.354-90.584c-15.754-7.877-19.692-27.57-11.815-43.323 3.938-7.877 15.754-15.754 27.569-15.754zM256.497 689.23H59.574l27.57-149.66 181.168 90.584c15.754 7.877 23.631 27.57 15.754 43.323-3.938 7.877-15.754 15.754-27.569 15.754zm256 334.77c-252.062 0-464.738-177.23-512-421.415-3.938-31.508 15.754-63.016 51.2-70.893 31.508-3.938 63.015 15.754 66.954 47.262C154.097 768 319.512 901.908 512.497 901.908c189.046 0 346.585-126.031 389.908-307.2 7.877-31.508 39.384-51.2 70.892-43.323 31.508 7.877 51.2 39.384 43.323 70.892C961.482 858.585 756.682 1024 512.497 1024zM965.42 500.185c-27.57 0-55.138-19.693-59.077-51.2C874.835 256 709.42 118.154 512.497 118.154c-185.108 0-350.523 129.97-389.908 307.2-7.877 31.508-39.384 51.2-70.892 43.323-31.508-7.877-51.2-39.385-43.323-70.892C59.574 169.354 272.251 0 512.497 0c256 0 472.615 181.17 512 429.292 3.938 31.508-15.754 63.016-47.262 66.954-3.938 3.939-7.876 3.939-11.815 3.939z",fill:"currentColor","fill-opacity":"0.9"},null,-1),ot=[tt];function nt(e,o,n,t,s,c){return h(),T("svg",{class:D(e.classes),style:R(e.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},ot,6)}const co=Me(et,[["render",nt]]),{componentName:st,create:it}=J("navbar"),lt=it({components:{Left:xe},props:{leftShow:{type:Boolean,default:!1},title:{type:String,default:""},titleIcon:{type:Boolean,default:!1},leftText:{type:String,default:""},desc:{type:String,default:""},fixed:{type:Boolean,default:!1},safeAreaInsetTop:{type:Boolean,default:!1},border:{type:Boolean,default:!1},placeholder:{type:Boolean,default:!0},zIndex:{type:[Number,String],default:10}},emits:["clickBack","clickTitle","clickIcon","clickRight","onClickBack","onClickTitle","onClickIcon","onClickRight"],setup(e,{emit:o}){const{border:n,fixed:t,safeAreaInsetTop:s,placeholder:c}=x(e),l=ee("auto"),u=ee(),g=y(()=>{const S=st;return{[S]:!0,[`${S}--border`]:n.value,[`${S}--fixed`]:t.value,[`${S}--safe-area-inset-top`]:s.value}}),k=y(()=>t.value&&c.value?{height:l.value}:{}),d=()=>{if(u.value){const S=u.value.getBoundingClientRect();l.value=`${S.height}px`}};return we(()=>{t.value&&c.value&&te(()=>{d()})}),{navbarRef:u,rootStyle:k,classes:g,navHeight:l,handleLeft:()=>{o("clickBack"),o("onClickBack")},handleCenter:()=>{o("clickTitle"),o("onClickTitle")},handleCenterIcon:()=>{o("clickIcon"),o("onClickIcon")},handleRight:()=>{o("clickRight"),o("onClickRight")}}}}),at={key:1,class:"nut-navbar__text"},rt={class:"nut-navbar__title"},ut={key:0,class:"nut-navbar__text"};function dt(e,o,n,t,s,c){const l=W("Left");return h(),T("view",{class:"nut-navbar--placeholder",style:R(e.rootStyle)},[m("view",{ref:"navbarRef",class:D(e.classes),style:R({zIndex:e.zIndex})},[m("view",{class:"nut-navbar__left",onClick:o[0]||(o[0]=(...u)=>e.handleLeft&&e.handleLeft(...u))},[e.leftShow?A(e.$slots,"left-show",{key:0},()=>[Ne(l,{height:"12px",color:"#979797"})]):N("",!0),e.leftText?(h(),T("view",at,V(e.leftText),1)):N("",!0),A(e.$slots,"left")]),m("view",rt,[e.title?(h(),T("view",{key:0,class:"title",onClick:o[1]||(o[1]=(...u)=>e.handleCenter&&e.handleCenter(...u))},V(e.title),1)):N("",!0),e.titleIcon?(h(),T("view",{key:1,class:"icon",onClick:o[3]||(o[3]=(...u)=>e.handleCenterIcon&&e.handleCenterIcon(...u))},[A(e.$slots,"title-icon",{onClick:o[2]||(o[2]=(...u)=>e.handleCenterIcon&&e.handleCenterIcon(...u))})])):N("",!0),A(e.$slots,"content")]),m("view",{class:"nut-navbar__right",onClick:o[4]||(o[4]=(...u)=>e.handleRight&&e.handleRight(...u))},[e.desc?(h(),T("view",ut,V(e.desc),1)):N("",!0),A(e.$slots,"right")])],6)],4)}const ct=G(lt,[["render",dt]]),vt=e=>e,vo=vt(ct);var pt=Object.defineProperty,ft=Object.defineProperties,mt=Object.getOwnPropertyDescriptors,Te=Object.getOwnPropertySymbols,ht=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable,Ce=(e,o,n)=>o in e?pt(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,Se=(e,o)=>{for(var n in o||(o={}))ht.call(o,n)&&Ce(e,n,o[n]);if(Te)for(var n of Te(o))gt.call(o,n)&&Ce(e,n,o[n]);return e},yt=(e,o)=>ft(e,mt(o));function Ee(e,o){let n=null,t=Date.now();return function(){let s=Date.now(),c=o-(s-t);n&&clearTimeout(n),c<=0?(e.apply(null,arguments),t=Date.now()):n=setTimeout(e,c)}}const{create:wt,translate:$t}=J("video"),bt=wt({props:{source:{type:Object,default:{}},options:{type:Object,default:{autoplay:!1,volume:.5,poster:"",loop:!1,controls:!0,muted:!1,disabled:!1,playsinline:!1,touchPlay:!1,preload:""},required:!0},model:{type:String,default:""}},components:{},emits:["click","play","pause","playend","time"],setup(e,{emit:o,expose:n}){const t=oe({videoElm:null,initial:!0,showToolbox:!1,player:{$player:null,pos:null},progressBar:{progressElm:null,pos:null},videoSet:{loaded:0,displayTime:"00:00",totalTime:"00:00",progress:{width:0,current:0}},state:{controlShow:!0,vol:.5,currentTime:0,fullScreen:!1,playing:!1,isLoading:!1,isEnd:!1,isError:!1,isMuted:!1},showTouchMask:!1}),s=ee(null),c=y(()=>e.options.disabled);j(()=>e.source,a=>{a.src&&te(()=>{t.videoElm.load()})},{immediate:!0,deep:!0}),j(()=>e.options,a=>{t.state.isMuted=a?a.muted:!1},{immediate:!0});const l=()=>{t.videoElm=s.value,e.options.autoplay&&setTimeout(()=>{t.videoElm.play()},200),e.options.touchPlay&&(t.showTouchMask=!0),e.options.playsinline&&(t.videoElm.setAttribute("playsinline",e.options.playsinline),t.videoElm.setAttribute("webkit-playsinline",e.options.playsinline),t.videoElm.setAttribute("x5-video-player-type","h5-page"),t.videoElm.setAttribute("x5-video-player-fullscreen",!1)),X(),t.showToolbox?u():(t.videoElm.addEventListener("play",()=>{t.state.playing=!0,o("play",t.videoElm)}),t.videoElm.addEventListener("pause",()=>{t.state.playing=!1,o("pause",t.videoElm)}),t.videoElm.addEventListener("ended",f),t.videoElm.addEventListener("timeupdate",Ee(M,1e3)))},u=()=>{const a=s.value,v=s.value.getElementsByClassName("nut-video-controller__progress-value")[0];t.player.$player=a,t.progressBar.progressElm=v,t.progressBar.pos=v.getBoundingClientRect(),t.videoSet.progress.width=Math.round(v.getBoundingClientRect().width)},g=()=>{if(e.options.autoplay&&e.options.disabled)return t.state.playing=!0,!1;if(t.state.playing=!t.state.playing,t.videoElm)if(t.state.playing)try{setTimeout(()=>{t.videoElm.play()},200),t.videoElm.addEventListener("progress",()=>{d()}),t.videoElm.addEventListener("timeupdate",Ee(M,1e3)),t.videoElm.addEventListener("ended",f),o("play",t.videoElm)}catch{E()}else t.videoElm.pause(),o("pause",t.videoElm)},k=a=>{var v=Math.floor(a/3600);+v<10&&(v="0"+v);var p=Math.floor(a%3600/60);+p<10&&(p="0"+p);var w=Math.round(a%3600%60);+w<10&&(w="0"+w);var Y="";return v!=0?Y=v+":"+p+":"+w:Y=p+":"+w,Y},d=()=>{t.videoSet.loaded&&(t.videoSet.loaded=t.videoElm.buffered.end(0)/t.videoElm.duration*100)},M=()=>{const a=t.videoElm.currentTime/t.videoElm.duration;t.videoSet.progress.current=Math.round(t.videoSet.progress.width*a),t.videoSet.totalTime=k(t.videoElm.duration),t.videoSet.displayTime=k(t.videoElm.currentTime),o("time",t.videoSet.displayTime,t.videoSet.totalTime)},f=()=>{t.state.playing=!1,t.state.isEnd=!0,t.videoSet.displayTime="00:00",t.videoSet.progress.current=0,t.videoElm.currentTime=0,o("playend",t.videoElm)},E=()=>{t.state.isError=!0},X=()=>{t.state.vol=e.options.volume},S=()=>{t.state.isMuted=!t.state.isMuted,t.videoElm.muted=t.state.isMuted},F=()=>{},B=a=>{let p=a.targetTouches[0].pageX-t.progressBar.pos.left;p<=0&&(p=0),p>=t.videoSet.progress.width&&(p=t.videoSet.progress.width),t.videoSet.progress.current=p;let w=t.videoSet.progress.current/t.videoSet.progress.width;t.videoElm.duration&&O(w,t.videoElm.duration)},Z=a=>{let p=a.changedTouches[0].pageX-t.progressBar.pos.left;t.videoSet.progress.current=p;let w=p/t.videoSet.progress.width;t.videoElm.duration&&O(w,t.videoElm.duration)},O=(a,v)=>{t.videoElm.currentTime=Math.floor(a*v)},K=()=>{t.state.isError=!1,l()},z=()=>{t.state.fullScreen?(t.state.fullScreen=!1,document.webkitCancelFullScreen()):(t.state.fullScreen=!0,t.videoElm.webkitRequestFullScreen())};return n({play:g,pause:()=>{t.state.playing=!1,t.videoElm.pause(),o("pause",t.videoElm)},stop:()=>{f(),t.videoElm.pause()},muted:()=>{t.state.isMuted=!0,t.videoElm.muted=!0},unmuted:()=>{t.state.isMuted=!1,t.videoElm.muted=!1}}),we(()=>{l()}),yt(Se(Se({root:s},x(e)),x(t)),{handleError:E,isDisabled:c,play:g,handleMuted:S,touchSlidSrart:F,touchSlidMove:B,touchSlidEnd:Z,retry:K,fullScreen:z,translate:$t})}}),Tt={ref:"videocon",class:"nut-video"},Ct=["muted","autoplay","loop","poster","controls","preload"],St=["src","type"],Et={class:"nut-video-controller__now"},Pt={class:"nut-video-controller__progress"},kt={ref:"progressBar",class:"nut-video-controller__progress-value"},Mt=m("div",{class:"nut-video-controller__ball-move"},null,-1),It=[Mt],Nt={ref:"playedBar",class:"nut-video-controller__played"},Bt={class:"nut-video-controller__total"},Ot={class:"nut-video-error"},zt={class:"nut-video-error-tip"};function Dt(e,o,n,t,s,c){return h(),T("div",Tt,[m("video",{ref:"root",class:"nut-video-player",muted:e.options.muted,autoplay:e.options.autoplay,loop:e.options.loop,poster:e.options.poster,controls:e.options.controls,preload:e.options.preload,onError:o[0]||(o[0]=(...l)=>e.handleError&&e.handleError(...l))},[m("source",{src:e.source.src,type:e.source.type},null,8,St)],40,Ct),e.showToolbox&&!e.isDisabled?(h(),T("div",{key:0,ref:"touchMask",class:"nut-video-mask",onClick:o[1]||(o[1]=(...l)=>e.play&&e.play(...l))},null,512)):N("",!0),e.showToolbox&&!e.isDisabled?re((h(),T("div",{key:1,ref:"palyBtn",class:"nut-video-play-btn",onClick:o[2]||(o[2]=(...l)=>e.play&&e.play(...l))},null,512)),[[ue,!e.state.playing]]):N("",!0),re(m("div",{class:D(["nut-video-controller",{"nut-video-controller--show":!e.state.playing,"nut-video-controller--hide":e.state.playing}])},[m("div",{class:"nut-video-controller__playbtn",onClick:o[3]||(o[3]=(...l)=>e.play&&e.play(...l))}),m("div",Et,V(e.videoSet.displayTime),1),m("div",Pt,[m("div",kt,[m("div",{class:"buffered",style:R({width:`${e.videoSet.loaded}%`})},null,4),m("div",{class:"nut-video-controller__ball",style:R({transform:`translate3d(${e.videoSet.progress.current}px, -50%, 0)`}),onTouchmove:o[4]||(o[4]=de(l=>e.touchSlidMove(l),["stop","prevent"])),onTouchstart:o[5]||(o[5]=de(l=>e.touchSlidSrart(),["stop"])),onTouchend:o[6]||(o[6]=de(l=>e.touchSlidEnd(l),["stop"]))},It,36),m("div",Nt,null,512)],512)]),m("div",Bt,V(e.videoSet.totalTime),1),m("div",{class:D(["nut-video-controller__volume",{muted:e.state.isMuted}]),onClick:o[7]||(o[7]=(...l)=>e.handleMuted&&e.handleMuted(...l))},null,2),m("div",{class:"nut-video-controller__full",onClick:o[8]||(o[8]=(...l)=>e.fullScreen&&e.fullScreen(...l))})],2),[[ue,e.showToolbox&&!e.isDisabled]]),re(m("div",Ot,[m("p",zt,V(e.translate("errorTip")),1),m("p",{class:"nut-video-error-retry",onClick:o[9]||(o[9]=(...l)=>e.retry&&e.retry(...l))},V(e.translate("clickRetry")),1)],512),[[ue,e.state.isError]])],512)}const me=G(bt,[["render",Dt]]),{create:Xt,componentName:ve}=J("swiper"),Rt=Xt({props:{width:{type:[Number,String],default:window.innerWidth},height:{type:[Number,String],default:0},direction:{type:String,default:"horizontal"},paginationVisible:{type:Boolean,default:!1},paginationColor:{type:String,default:"#fff"},loop:{type:Boolean,default:!0},duration:{type:[Number,String],default:500},autoPlay:{type:[Number,String],default:0},initPage:{type:[Number,String],default:0},touchable:{type:Boolean,default:!0},isPreventDefault:{type:Boolean,default:!0},isStopPropagation:{type:Boolean,default:!0}},emits:["change"],setup(e,{emit:o,slots:n}){const t=ee(),s=oe({active:0,num:0,rect:null,width:0,height:0,moving:!1,offset:0,touchTime:0,autoplayTimer:null,children:[],childrenVNode:[],style:{}}),c=ze(),l=y(()=>({[ve]:!0})),u=y(()=>e.direction==="vertical"),g=y(()=>{const i=ve;return{[`${i}-inner`]:!0,[`${i}-vertical`]:u.value}}),k=y(()=>{const i=ve;return{[`${i}-pagination`]:!0,[`${i}-pagination-vertical`]:u.value}}),d=y(()=>u.value?c.deltaY.value:c.deltaX.value),M=y(()=>c.direction.value===e.direction),f=y(()=>s.children.length),E=y(()=>s[u.value?"height":"width"]),X=y(()=>f.value*E.value),S=y(()=>s.rect?(u.value?s.rect.height:s.rect.width)-E.value*f.value:0),F=y(()=>(s.active+f.value)%f.value),B=()=>{let i=0;i=s.offset,s.style={transitionDuration:`${s.moving?0:e.duration}ms`,transform:`translate${u.value?"Y":"X"}(${i}px)`,[u.value?"height":"width"]:`${E.value*f.value}px`,[u.value?"width":"height"]:`${u.value?s.width:s.height}px`}},Z=i=>{var P;let C=[];const I=s.childrenVNode.length;let U=(P=n==null?void 0:n.default)==null?void 0:P.call(n);if(U=U.filter($=>$.children&&Array.isArray($.children)),U.forEach($=>{C=C.concat($.children)}),!I)s.childrenVNode=C.slice(),i.proxy&&s.children.push(i.proxy);else if(I>C.length)s.children=s.children.filter($=>i.proxy!==$);else if(I<C.length){for(let $=0;$<I;$++)if(C[$].key!==s.childrenVNode[$].key){i.proxy&&s.children.splice($,0,i.proxy),i.vnode&&s.childrenVNode.splice($,0,i.vnode);break}I!==C.length&&(i.proxy&&s.children.push(i.proxy),i.vnode&&s.childrenVNode.push(i.vnode))}else s.childrenVNode=C.slice(),i.proxy&&s.children.push(i.proxy)},O=(i,P=0)=>{let C=i*E.value;e.loop||(C=Math.min(C,-S.value));let I=P-C;return e.loop||(I=H(I,S.value,0)),I},K=i=>{const{active:P}=s;return i?e.loop?H(P+i,-1,f.value):H(P+i,0,f.value-1):P},z=({pace:i=0,offset:P=0,isEmit:C=!1})=>{if(f.value<=1)return;const{active:I}=s,U=K(i),$=O(U,P);if(e.loop){if(s.children[0]&&$!==S.value){const ae=$<S.value;s.children[0].setOffset(ae?X.value:0)}if(s.children[f.value-1]&&$!==0){const ae=$>0;s.children[f.value-1].setOffset(ae?-X.value:0)}}s.active=U,s.offset=$,C&&I!==s.active&&o("change",F.value),B()},q=()=>{s.moving=!0,s.active<=-1&&z({pace:f.value}),s.active>=f.value&&z({pace:-f.value})},L=()=>{s.autoplayTimer&&clearTimeout(s.autoplayTimer)},Q=i=>{q(),c.reset(),ce(()=>{ce(()=>{s.moving=!1,z({pace:i,isEmit:!0})})})},r=()=>{Q(-1)},a=()=>{Q(1)},v=i=>{q(),c.reset(),ce(()=>{s.moving=!1;let P;e.loop&&f.value===i?P=s.active===0?0:i:P=i%f.value,z({pace:P-s.active,isEmit:!0})})},p=()=>{+e.autoPlay<=0||f.value<=1||(L(),s.autoplayTimer=setTimeout(()=>{a(),p()},Number(e.autoPlay)))},w=(i=+e.initPage)=>{L(),s.rect=t.value.getBoundingClientRect(),i=Math.min(f.value-1,i),s.width=e.width?+e.width:s.rect.width,s.height=e.height?+e.height:s.rect.height,s.active=i,s.offset=O(s.active),s.moving=!0,B(),p()},Y=i=>{e.isPreventDefault&&i.preventDefault(),e.isStopPropagation&&i.stopPropagation(),e.touchable&&(c.start(i),s.touchTime=Date.now(),L(),q())},ne=i=>{e.touchable&&s.moving&&(c.move(i),M.value&&z({offset:d.value}))},le=()=>{if(!e.touchable||!s.moving)return;const i=d.value/(Date.now()-s.touchTime);if((Math.abs(i)>.3||Math.abs(d.value)>+(E.value/2).toFixed(2))&&M.value){let C=0;const I=u.value?c.offsetY.value:c.offsetX.value;e.loop?C=I>0?d.value>0?-1:1:0:C=-Math[d.value>0?"ceil":"floor"](d.value/E.value),z({pace:C,isEmit:!0})}else d.value&&z({pace:0});s.moving=!1,B(),p()};return Le("parent",{props:e,size:E,relation:Z}),De({prev:r,next:a,to:v}),Ye(()=>{L()}),Ae(()=>{L()}),j(()=>e.initPage,i=>{te(()=>{w(Number(i))})}),j(()=>s.children.length,()=>{te(()=>{w()})}),j(()=>e.autoPlay,i=>{+i>0?p():L()}),{state:s,classes:l,classesInner:g,classesPagination:k,container:t,activePagination:F,onTouchStart:Y,onTouchMove:ne,onTouchEnd:le}}});function Lt(e,o,n,t,s,c){return h(),T("view",{ref:"container",class:D(e.classes),onTouchstart:o[0]||(o[0]=(...l)=>e.onTouchStart&&e.onTouchStart(...l)),onTouchmove:o[1]||(o[1]=(...l)=>e.onTouchMove&&e.onTouchMove(...l)),onTouchend:o[2]||(o[2]=(...l)=>e.onTouchEnd&&e.onTouchEnd(...l)),onTouchcancel:o[3]||(o[3]=(...l)=>e.onTouchEnd&&e.onTouchEnd(...l))},[m("view",{class:D(e.classesInner),style:R(e.state.style)},[A(e.$slots,"default")],6),A(e.$slots,"page"),e.paginationVisible&&!e.$slots.page?(h(),T("view",{key:0,class:D(e.classesPagination)},[(h(!0),T(Be,null,Oe(e.state.children.length,(l,u)=>(h(),T("i",{key:u,style:R({backgroundColor:e.activePagination===u?e.paginationColor:"#ddd"}),class:D({active:e.activePagination===u})},null,6))),128))],2)):N("",!0)],34)}const he=G(Rt,[["render",Lt]]),{create:Yt,componentName:At}=J("swiper-item"),Vt=Yt({setup(){const e=Ve("parent");e.relation($e());const o=oe({offset:0}),n=y(()=>({[At]:!0})),t=y(()=>{const c={},l=e==null?void 0:e.props.direction;return e!=null&&e.size.value&&(c[l==="horizontal"?"width":"height"]=`${e==null?void 0:e.size.value}px`),o.offset&&(c.transform=`translate${l==="horizontal"?"X":"Y"}(${o.offset}px)`),c}),s=c=>{o.offset=c};return je(()=>{e.relation($e(),"unmount")}),De({setOffset:s}),{style:t,classes:n}}});function jt(e,o,n,t,s,c){return h(),T("view",{class:D(e.classes),style:R(e.style)},[A(e.$slots,"default")],6)}const ge=G(Vt,[["render",jt]]);var Ht=Object.defineProperty,Ft=Object.defineProperties,Wt=Object.getOwnPropertyDescriptors,Pe=Object.getOwnPropertySymbols,Zt=Object.prototype.hasOwnProperty,qt=Object.prototype.propertyIsEnumerable,ke=Math.pow,ye=(e,o,n)=>o in e?Ht(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,se=(e,o)=>{for(var n in o||(o={}))Zt.call(o,n)&&ye(e,n,o[n]);if(Pe)for(var n of Pe(o))qt.call(o,n)&&ye(e,n,o[n]);return e},ie=(e,o)=>Ft(e,Wt(o)),b=(e,o,n)=>(ye(e,typeof o!="symbol"?o+"":o,n),n);const Xe={show:{type:Boolean,default:!1},initNo:{type:Number,default:0},showIndex:{type:Boolean,default:!0},minZoom:{type:Number,default:1/3},maxZoom:{type:Number,default:3}},{create:Ut}=J("image-preview-item"),Gt=Ut({props:ie(se({},Xe),{image:{type:Object,default:()=>({})},video:{type:Object,default:()=>({})},rootWidth:{type:Number,default:0},rootHeight:{type:Number,default:0},contentClose:{type:Boolean,default:!0}}),emits:["close","scale"],components:{[me.name]:me,[ge.name]:ge},setup(e,{emit:o}){const n=oe({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}),t=ze(),s=y(()=>{const{rootWidth:r,rootHeight:a}=e,v=a/r;return n.imageRatio>v}),c=y(()=>{const r=e.image;if(r&&r.src){const{scale:a,moveX:v,moveY:p,moving:w,zooming:Y}=n,ne={transitionDuration:Y||w?"0s":".3s"};if(a!==1){const le=v/a,i=p/a;ne.transform=`scale(${a}, ${a}) translate(${le}px, ${i}px)`}return ne}return{}}),l=y(()=>{if(n.imageRatio){const{rootWidth:r,rootHeight:a}=e,v=s.value?a/n.imageRatio:r;return Math.max(0,(n.scale*v-r)/2)}return 0}),u=y(()=>{if(n.imageRatio){const{rootWidth:r,rootHeight:a}=e,v=s.value?a:r*n.imageRatio;return Math.max(0,(n.scale*v-a)/2)}return 0}),g=r=>{const{naturalWidth:a,naturalHeight:v}=r.target;n.imageRatio=v/a},k=()=>{d(1),n.moveX=0,n.moveY=0},d=r=>{r=H(r,+e.minZoom,+e.maxZoom+1),r!==n.scale&&(n.scale=r,o("scale",{scale:r,index:e.initNo}))},M=()=>{const r=n.scale>1?1:2;d(r),n.moveX=0,n.moveY=0},f=r=>Math.sqrt(ke(r[0].clientX-r[1].clientX,2)+ke(r[0].clientY-r[1].clientY,2));let E,X,S,F,B,Z,O;const K=r=>{const{touches:a}=r,{offsetX:v}=t;t.start(r),O=a.length,E=n.moveX,X=n.moveY,Z=Date.now(),n.moving=O===1&&n.scale!==1,n.zooming=O===2&&!v.value,n.zooming&&(S=n.scale,F=f(r.touches))},z=r=>{const{touches:a}=r;if(t.move(r),(n.moving||n.zooming)&&be(r,!0),n.moving){const{deltaX:v,deltaY:p}=t,w=v.value+E,Y=p.value+X;n.moveX=H(w,-l.value,l.value),n.moveY=H(Y,-u.value,u.value)}if(n.zooming&&a.length===2){const v=f(a),p=S*v/F;d(p)}},q=()=>{if(O==1&&e.video&&e.video.source||O>1)return;const{offsetX:r,offsetY:a}=t,v=Date.now()-Z,p=250,w=5;r.value<w&&a.value<w&&v<p&&(B?(clearTimeout(B),B=null,M()):B=setTimeout(()=>{e.contentClose&&o("close"),B=null},p))},L=r=>{let a=!1;(n.moving||n.zooming)&&(a=!0,n.moving&&E===n.moveX&&X===n.moveY&&(a=!1),r.touches.length||(n.zooming&&(n.moveX=H(n.moveX,-l.value,l.value),n.moveY=H(n.moveY,-u.value,u.value),n.zooming=!1),n.moving=!1,E=0,X=0,S=1,n.scale<1&&k(),n.scale>e.maxZoom&&(n.scale=+e.maxZoom))),be(r,a),q(),t.reset()},Q=()=>{o("close")};return j(()=>e.initNo,k),j(()=>e.show,r=>{r||k()}),ie(se({},x(n)),{onTouchStart:K,onTouchMove:z,onTouchEnd:L,getDistance:f,imageStyle:c,imageLoad:g,closeSwiper:Q})}}),Jt=["src"];function Kt(e,o,n,t,s,c){const l=W("nut-video"),u=W("nut-swiper-item");return h(),_(u,{onClick:e.closeSwiper},{default:fe(()=>[m("view",{style:R(e.imageStyle),class:"nut-image-preview-box",onTouchstart:o[1]||(o[1]=(...g)=>e.onTouchStart&&e.onTouchStart(...g)),onTouchmove:o[2]||(o[2]=(...g)=>e.onTouchMove&&e.onTouchMove(...g)),onTouchend:o[3]||(o[3]=(...g)=>e.onTouchEnd&&e.onTouchEnd(...g)),onTouchcancel:o[4]||(o[4]=(...g)=>e.onTouchEnd&&e.onTouchEnd(...g))},[e.image&&e.image.src?(h(),T("img",{key:0,src:e.image.src,class:"nut-image-preview-img",onLoad:o[0]||(o[0]=(...g)=>e.imageLoad&&e.imageLoad(...g))},null,40,Jt)):N("",!0),e.video&&e.video.source?(h(),_(l,{key:1,source:e.video.source,options:e.video.options},null,8,["source","options"])):N("",!0)],36)]),_:1},8,["onClick"])}const Qt=G(Gt,[["render",Kt]]),{create:_t}=J("image-preview"),xt=_t({props:ie(se({},Xe),{images:{type:Array,default:()=>[]},videos:{type:Array,default:()=>[]},contentClose:{type:Boolean,default:!0},paginationVisible:{type:Boolean,default:!1},paginationColor:{type:String,default:"#fff"},autoplay:{type:[Number,String],default:0},teleport:{type:[String,Element],default:"body"},teleportDisable:{ype:Boolean,default:!1},closeable:{type:Boolean,default:!1},closeIconPosition:{type:String,default:"top-right"},beforeClose:Function,isLoop:{type:Boolean,default:!0}}),emits:["close","change"],components:{ImagePreviewItem:Qt,CircleClose:Ge,[pe.name]:pe,[he.name]:he},setup(e,{emit:o}){const n=ee(),t=oe({showPop:e.show,active:0,rootWidth:0,rootHeight:0}),s=y(()=>{const d="nut-image-preview-close";return`nut-image-preview-close-icon ${e.closeIconPosition=="top-right"?`${d}-right`:`${d}-left`}`}),c=y(()=>He(e.videos)?[].concat(e.videos).concat(e.images):e.images),l=d=>{d!==t.active&&(t.active=d,o("change",t.active))},u=()=>{qe(e.beforeClose,{args:[t.active],done:()=>g()})},g=()=>{t.showPop=!1,o("close")},k=()=>{if(n.value){const d=Ue(n.value);t.rootHeight=d.height,t.rootWidth=d.width}};return j(()=>e.show,d=>{t.showPop=d,d&&(l(e.initNo),k())}),j(()=>e.initNo,d=>{d!=t.active&&l(d)}),we(()=>{l(e.initNo)}),ie(se({swipeRef:n},x(t)),{onClose:u,mergeImages:c,setActive:l,iconClasses:s})}}),eo={ref:"swipeRef",class:"nut-image-preview"},to={key:0,class:"nut-image-preview-index"};function oo(e,o,n,t,s,c){const l=W("image-preview-item"),u=W("nut-swiper"),g=W("CircleClose"),k=W("nut-popup");return h(),_(k,{visible:e.showPop,"onUpdate:visible":o[1]||(o[1]=d=>e.showPop=d),"pop-class":"nut-image-preview-custom-pop","teleport-disable":e.teleportDisable,teleport:e.teleport,"lock-scroll":"",onClosed:e.onClose},{default:fe(()=>[m("view",eo,[e.showPop?(h(),_(u,{key:0,"auto-play":e.autoplay,class:"nut-image-preview-swiper",loop:e.isLoop,"is-prevent-default":!1,direction:"horizontal","init-page":e.initNo,"pagination-visible":e.paginationVisible,"pagination-color":e.paginationColor,onChange:e.setActive},{default:fe(()=>[(h(!0),T(Be,null,Oe(e.mergeImages,(d,M)=>(h(),_(l,{key:M,video:M<e.videos.length?d:{},image:M>=e.videos.length?d:{},"root-height":e.rootHeight,"root-width":e.rootWidth,show:e.showPop,"init-no":e.active+1,"content-close":e.contentClose,"max-zoom":e.maxZoom,"min-zoom":e.minZoom,onClose:e.onClose},null,8,["video","image","root-height","root-width","show","init-no","content-close","max-zoom","min-zoom","onClose"]))),128))]),_:1},8,["auto-play","loop","init-page","pagination-visible","pagination-color","onChange"])):N("",!0)],512),e.showIndex?(h(),T("view",to,V(e.active+1)+" / "+V(e.mergeImages.length),1)):N("",!0),e.closeable?(h(),T("view",{key:1,class:D(e.iconClasses),onClick:o[0]||(o[0]=(...d)=>e.onClose&&e.onClose(...d))},[A(e.$slots,"close-icon",{},()=>[Ne(g,{color:"#ffffff"})])],2)):N("",!0)]),_:3},8,["visible","teleport-disable","teleport","onClosed"])}const Re=G(xt,[["render",oo]]);class no{constructor(){b(this,"show",!1),b(this,"images",[]),b(this,"videos",[]),b(this,"contentClose",!0),b(this,"initNo",0),b(this,"paginationVisible",!1),b(this,"paginationColor",""),b(this,"autoplay",0),b(this,"isWrapTeleport",!1),b(this,"showIndex",!0),b(this,"closeable",!1),b(this,"closeIcon","circle-close"),b(this,"closeIconPosition","top-right"),b(this,"beforeClose"),b(this,"maxZoom",3),b(this,"minZoom",1/3),b(this,"isLoop",!0),b(this,"teleport","body")}}class so{constructor(o){b(this,"options",new no);const n=Object.assign(this.options,o),{unmount:t}=Fe(n,{name:"image-preview",components:[pe,me,he,ge,We],wrapper:()=>({setup(){return()=>(n.onClose=()=>{n.show=!1,te(()=>{t()})},Ze(Re,n))}})})}}const io=e=>new so(e);io.install=e=>{e.use(Re)};export{vo as N,io as s,co as w};
